/*
 Highcharts JS v11.1.0 (2023-08-20)

 Highcharts

 (c) 2010-2023 Highsoft AS

 License: www.highcharts.com/license
*/
'use strict';var t=t||{};t.scope={};t.arrayIteratorImpl=function(d){var l=0;return function(){return l<d.length?{done:!1,value:d[l++]}:{done:!0}}};t.arrayIterator=function(d){return{next:t.arrayIteratorImpl(d)}};t.ASSUME_ES5=!1;t.ASSUME_NO_NATIVE_MAP=!1;t.ASSUME_NO_NATIVE_SET=!1;t.SIMPLE_FROUND_POLYFILL=!1;t.ISOLATE_POLYFILLS=!1;
t.defineProperty=t.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,l,n){if(d==Array.prototype||d==Object.prototype)return d;d[l]=n.value;return d};t.getGlobal=function(d){d=["object"==typeof globalThis&&globalThis,d,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var l=0;l<d.length;++l){var n=d[l];if(n&&n.Math==Math)return n}throw Error("Cannot find global object");};t.global=t.getGlobal(this);
t.SYMBOL_PREFIX="jscomp_symbol_";t.initSymbol=function(){t.initSymbol=function(){};t.global.Symbol||(t.global.Symbol=t.Symbol)};t.SymbolClass=function(d,l){this.$jscomp$symbol$id_=d;t.defineProperty(this,"description",{configurable:!0,writable:!0,value:l})};t.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
t.Symbol=function(){function d(n){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new t.SymbolClass(t.SYMBOL_PREFIX+(n||"")+"_"+l++,n)}var l=0;return d}();
t.initSymbolIterator=function(){t.initSymbol();var d=t.global.Symbol.iterator;d||(d=t.global.Symbol.iterator=t.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[d]&&t.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return t.iteratorPrototype(t.arrayIteratorImpl(this))}});t.initSymbolIterator=function(){}};
t.initSymbolAsyncIterator=function(){t.initSymbol();var d=t.global.Symbol.asyncIterator;d||(d=t.global.Symbol.asyncIterator=t.global.Symbol("Symbol.asyncIterator"));t.initSymbolAsyncIterator=function(){}};t.iteratorPrototype=function(d){t.initSymbolIterator();d={next:d};d[t.global.Symbol.iterator]=function(){return this};return d};
t.iteratorFromArray=function(d,l){t.initSymbolIterator();d instanceof String&&(d+="");var n=0,c={next:function(){if(n<d.length){var h=n++;return{value:l(h,d[h]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};t.polyfills={};t.propertyToPolyfillSymbol={};t.POLYFILL_PREFIX="$jscp$";t.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");
t.polyfill=function(d,l,n,c){l&&(t.ISOLATE_POLYFILLS?t.polyfillIsolated(d,l,n,c):t.polyfillUnisolated(d,l,n,c))};t.polyfillUnisolated=function(d,l){var n=t.global;d=d.split(".");for(var c=0;c<d.length-1;c++){var h=d[c];h in n||(n[h]={});n=n[h]}d=d[d.length-1];c=n[d];l=l(c);l!=c&&null!=l&&t.defineProperty(n,d,{configurable:!0,writable:!0,value:l})};
t.polyfillIsolated=function(d,l,n){var c=d.split(".");d=1===c.length;var h=c[0];h=!d&&h in t.polyfills?t.polyfills:t.global;for(var g=0;g<c.length-1;g++){var b=c[g];b in h||(h[b]={});h=h[b]}c=c[c.length-1];n=t.IS_SYMBOL_NATIVE&&"es6"===n?h[c]:null;l=l(n);null!=l&&(d?t.defineProperty(t.polyfills,c,{configurable:!0,writable:!0,value:l}):l!==n&&(t.propertyToPolyfillSymbol[c]=t.IS_SYMBOL_NATIVE?t.global.Symbol(c):t.POLYFILL_PREFIX+c,c=t.propertyToPolyfillSymbol[c],t.defineProperty(h,c,{configurable:!0,
writable:!0,value:l})))};t.polyfill("Array.prototype.values",function(d){return d?d:function(){return t.iteratorFromArray(this,function(d,n){return n})}},"es8","es3");
(function(d){"object"===typeof module&&module.exports?(d["default"]=d,module.exports=d):"function"===typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts"],function(l){d(l);d.Highcharts=l;return d}):d("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(d){function l(d,c,h,g){d.hasOwnProperty(c)||(d[c]=g.apply(null,h),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:c,module:d[c]}})))}d=d?d._modules:{};l(d,
"Data/Modifiers/DataModifier.js",[d["Core/Utilities.js"]],function(d){const {addEvent:c,fireEvent:h,merge:g}=d;class b{benchmark(a,f){const e=[],b=this,p=()=>{b.modifyTable(a);b.emit({type:"afterBenchmarkIteration"})},{iterations:q}=g({iterations:1},f);b.on("afterBenchmarkIteration",()=>{e.length===q?b.emit({type:"afterBenchmark",results:e}):p()});var c=0,d=0;b.on("modify",()=>{c=window.performance.now()});b.on("afterModify",()=>{d=window.performance.now();e.push(d-c)});p();return e}emit(a){h(this,
a.type,a)}modify(a,b){const e=this;return new Promise((f,p)=>{a.modified===a&&(a.modified=a.clone(!1,b));try{f(e.modifyTable(a,b))}catch(q){e.emit({type:"error",detail:b,table:a}),p(q)}})}modifyCell(a){return this.modifyTable(a)}modifyColumns(a){return this.modifyTable(a)}modifyRows(a){return this.modifyTable(a)}on(a,b){return c(this,a,b)}}(function(a){a.types={};a.registerType=function(b,e){return!!b&&!a.types[b]&&!!(a.types[b]=e)}})(b||(b={}));return b});l(d,"Data/DataTable.js",[d["Core/Utilities.js"]],
function(d){const {addEvent:c,fireEvent:h,uniqueKey:g}=d;class b{static isNull(a){if(a===b.NULL)return!0;if(a instanceof Array){if(!a.length)return!1;for(let b=0,e=a.length;b<e;++b)if(null!==a[b])return!1}else{const b=Object.keys(a);if(!b.length)return!1;for(let e=0,f=b.length;e<f;++e)if(null!==a[b[e]])return!1}return!0}constructor(a={}){this.aliases={};this.autoId=!a.id;this.columns={};this.id=a.id||g();this.modified=this;this.rowCount=0;this.versionTag=g();var b=a.columns||{},e=Object.keys(b);const k=
this.columns;let p=0;for(let a=0,f=e.length,c,g;a<f;++a)g=e[a],c=b[g].slice(),k[g]=c,p=Math.max(p,c.length);for(let a=0,b=e.length;a<b;++a)k[e[a]].length=p;this.rowCount=p;a=a.aliases||{};b=Object.keys(a);e=this.aliases;for(let f=0,k=b.length,p;f<k;++f)p=b[f],e[p]=a[p]}clone(a,f){var e={};this.emit({type:"cloneTable",detail:f});a||(e.aliases=this.aliases,e.columns=this.columns);this.autoId||(e.id=this.id);e=new b(e);a||(e.versionTag=this.versionTag);this.emit({type:"afterCloneTable",detail:f,tableClone:e});
return e}deleteColumnAlias(a){const b=this.aliases[a],e=this.modifier;b&&(delete this.aliases[a],e&&e.modifyColumns(this,{[b]:Array(this.rowCount)},0));return b}deleteColumns(a,b){const e=this.columns,f={},p={},q=this.modifier,c=this.rowCount;a=a||Object.keys(e);if(a.length){this.emit({type:"deleteColumns",columnNames:a,detail:b});for(let b=0,k=a.length,q,g;b<k;++b){g=a[b];if(q=e[g])f[g]=q,p[g]=Array(c);delete e[g]}Object.keys(e).length||(this.rowCount=0);q&&q.modifyColumns(this,p,0,b);this.emit({type:"afterDeleteColumns",
columns:f,columnNames:a,detail:b});return f}}deleteRows(a,b=1,e){const f=[],p=[],q=this.modifier;this.emit({type:"deleteRows",detail:e,rowCount:b,rowIndex:a||0});"undefined"===typeof a&&(a=0,b=this.rowCount);if(0<b&&a<this.rowCount){const e=this.columns,k=Object.keys(e);for(let q=0,c=k.length,g,d;q<c;++q){g=e[k[q]];d=g.splice(a,b);q||(this.rowCount=g.length);for(let a=0,e=d.length;a<e;++a)f[a]=f[a]||[],f[a][q]=d[a];p.push(Array(c))}}q&&q.modifyRows(this,p,a||0,e);this.emit({type:"afterDeleteRows",
detail:e,rowCount:b,rowIndex:a||0,rows:f});return f}emit(a){switch(a.type){case "afterDeleteColumns":case "afterDeleteRows":case "afterSetCell":case "afterSetColumns":case "afterSetRows":this.versionTag=g()}h(this,a.type,a)}getCell(a,b){a=this.aliases[a]||a;if(a=this.columns[a])return a[b]}getCellAsBoolean(a,b){a=this.aliases[a]||a;a=this.columns[a];return!(!a||!a[b])}getCellAsNumber(a,b,e){a=this.aliases[a]||a;b=(a=this.columns[a])&&a[b];switch(typeof b){case "boolean":return b?1:0;case "number":return isNaN(b)&&
!e?null:b}b=parseFloat(`${b}`);return isNaN(b)&&!e?null:b}getCellAsString(a,b){a=this.aliases[a]||a;a=this.columns[a];return`${a&&a[b]}`}getColumn(a,b){return this.getColumns([a],b)[a]}getColumnAliases(){const a=this.aliases,b=Object.keys(a),e={};for(let f=0,p=b.length,q;f<p;++f)q=b[f],e[q]=a[q];return e}getColumnAsNumbers(a,b){var e=this.columns;a=this.aliases[a]||a;const f=e[a];e=[];if(f){const k=f.length;if(b)for(b=0;b<k;++b)e.push(this.getCellAsNumber(a,b,!0));else{for(let a=0,b;a<k;++a){b=f[a];
if("number"===typeof b)return f.slice();if(null!==b&&"undefined"!==typeof b)break}for(b=0;b<k;++b)e.push(this.getCellAsNumber(a,b))}}return e}getColumnNames(){return Object.keys(this.columns)}getColumns(a,b){const e=this.aliases,f=this.columns,p={};a=a||Object.keys(f);for(let k=0,c=a.length,g,d;k<c;++k)d=a[k],(g=f[e[d]||d])&&(p[d]=b?g:g.slice());return p}getModifier(){return this.modifier}getRow(a,b){return this.getRows(a,1,b)[0]}getRowCount(){return this.rowCount}getRowIndexBy(a,b,e){a=this.aliases[a]||
a;if(a=this.columns[a])if(b=a.indexOf(b,e),-1!==b)return b}getRowObject(a,b){return this.getRowObjects(a,1,b)[0]}getRowObjects(a=0,b=this.rowCount-a,e){const k=this.aliases,f=this.columns,c=Array(b);e=e||Object.keys(f);for(let p=a,q=0,g=Math.min(this.rowCount,a+b),d,m;p<g;++p,++q){m=c[q]={};for(const a of e)d=f[k[a]||a],m[a]=d?d[p]:void 0}return c}getRows(a=0,b=this.rowCount-a,e){const k=this.aliases,f=this.columns,c=Array(b);e=e||Object.keys(f);for(let p=a,q=0,g=Math.min(this.rowCount,a+b),d,m;p<
g;++p,++q){m=c[q]=[];for(const a of e)d=f[k[a]||a],m.push(d?d[p]:void 0)}return c}getVersionTag(){return this.versionTag}hasColumns(a){const b=this.aliases,e=this.columns;for(let k=0,f=a.length,c;k<f;++k)if(c=a[k],!e[c]&&!b[c])return!1;return!0}hasRowWith(a,b){a=this.aliases[a]||a;return(a=this.columns[a])?-1!==a.indexOf(b):!1}on(a,b){return c(this,a,b)}renameColumn(a,b){const e=this.columns;if(e[a]){if(a!==b){const k=this.aliases;k[b]&&delete k[b];e[b]=e[a];delete e[a]}return!0}return!1}setCell(a,
b,e,k){const f=this.columns,c=this.modifier;a=this.aliases[a]||a;let g=f[a];g&&g[b]===e||(this.emit({type:"setCell",cellValue:e,columnName:a,detail:k,rowIndex:b}),g||(g=f[a]=Array(this.rowCount)),b>=this.rowCount&&(this.rowCount=b+1),g[b]=e,c&&c.modifyCell(this,a,b,e),this.emit({type:"afterSetCell",cellValue:e,columnName:a,detail:k,rowIndex:b}))}setColumn(a,b=[],e=0,k){this.setColumns({[a]:b},e,k)}setColumnAlias(a,b){const e=this.aliases;return e[a]?!1:(e[a]=b,!0)}setColumns(a,b,e){const k=this.columns,
f=this.modifier;var c="undefined"===typeof b;const g=Object.keys(a);this.emit({type:"setColumns",columns:a,columnNames:g,detail:e,rowIndex:b});for(let e=0,f=g.length,p,q;e<f;++e)if(q=g[e],p=a[q],q=this.aliases[q]||q,c)k[q]=p.slice(),this.rowCount=p.length;else{const a=k[q]?k[q]:k[q]=Array(this.rowCount);for(let e=b||0,k=p.length;e<k;++e)a[e]=p[e];this.rowCount=Math.max(this.rowCount,a.length)}c=Object.keys(k);for(let a=0,b=c.length;a<b;++a)k[c[a]].length=this.rowCount;f&&f.modifyColumns(this,a,b||
0);this.emit({type:"afterSetColumns",columns:a,columnNames:g,detail:e,rowIndex:b})}setModifier(a,b){const e=this;e.emit({type:"setModifier",detail:b,modifier:a,modified:e.modified});e.modified=e;e.modifier=a;return(a?a.modify(e):Promise.resolve(e)).then(e=>{e.emit({type:"afterSetModifier",detail:b,modifier:a,modified:e.modified});return e})["catch"](b=>{e.emit({type:"setModifierError",error:b,modifier:a,modified:e.modified});throw b;})}setRow(a,b,e){this.setRows([a],b,e)}setRows(a,f=this.rowCount,
e){var k=this.aliases;const p=this.columns,c=Object.keys(p),g=this.modifier,d=a.length;this.emit({type:"setRows",detail:e,rowCount:d,rowIndex:f,rows:a});for(let e=0,g=f,q;e<d;++e,++g)if(q=a[e],q===b.NULL)for(let a=0,b=c.length;a<b;++a)p[c[a]][g]=null;else if(q instanceof Array)for(let a=0,b=c.length;a<b;++a)p[c[a]][g]=q[a];else{const a=Object.keys(q);for(let b=0,e=a.length,f;b<e;++b)f=a[b],f=k[f]||f,p[f]||(p[f]=Array(g+1)),p[f][g]=q[f]}k=f+d;if(k>this.rowCount){this.rowCount=k;for(let a=0,b=c.length;a<
b;++a)p[c[a]].length=k}g&&g.modifyRows(this,a,f);this.emit({type:"afterSetRows",detail:e,rowCount:d,rowIndex:f,rows:a})}}b.NULL={};"";return b});l(d,"Data/Connectors/DataConnector.js",[d["Data/Modifiers/DataModifier.js"],d["Data/DataTable.js"],d["Core/Utilities.js"]],function(d,c,h){const {addEvent:g,fireEvent:b,merge:a,pick:f}=h;class e{constructor(a={}){this.table=new c(a.dataTable);this.metadata=a.metadata||{columns:{}}}get polling(){return!!this.polling}describeColumn(b,e){const k=this.metadata.columns;
k[b]=a(k[b]||{},e)}describeColumns(a){const b=Object.keys(a);let e;for(;"string"===typeof(e=b.pop());)this.describeColumn(e,a[e])}emit(a){b(this,a.type,a)}getColumnOrder(){const a=this.metadata.columns,b=Object.keys(a||{});if(b.length)return b.sort((b,e)=>f(a[b].index,0)-f(a[e].index,0))}getSortedColumns(a){return this.table.getColumns(this.getColumnOrder(a))}load(){b(this,"afterLoad",{table:this.table});return Promise.resolve(this)}on(a,b){return g(this,a,b)}save(){b(this,"saveError",{table:this.table});
return Promise.reject(Error("Not implemented"))}setColumnOrder(a){for(let b=0,e=a.length;b<e;++b)this.describeColumn(a[b],{index:b})}setModifierOptions(a){const b=a&&d.types[a.type];return this.table.setModifier(b?new b(a):void 0).then(()=>this)}startPolling(a=1E3){const b=this;window.clearTimeout(b._polling);b._polling=window.setTimeout(()=>b.load()["catch"](a=>b.emit({type:"loadError",error:a,table:b.table})).then(()=>{b._polling&&b.startPolling(a)}),a)}stopPolling(){window.clearTimeout(this._polling);
delete this._polling}whatIs(a){return this.metadata.columns[a]}}(function(a){a.types={};a.registerType=function(b,e){return!!b&&!a.types[b]&&!!(a.types[b]=e)}})(e||(e={}));return e});l(d,"Data/Converters/DataConverter.js",[d["Data/DataTable.js"],d["Core/Utilities.js"]],function(d,c){const {addEvent:h,fireEvent:g,isNumber:b,merge:a}=c;class f{constructor(b){this.dateFormats={"YYYY/mm/dd":{regex:/^([0-9]{4})([\-\.\/])([0-9]{1,2})\2([0-9]{1,2})$/,parser:function(a){return a?Date.UTC(+a[1],a[3]-1,+a[4]):
NaN}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(a){return a?Date.UTC(+a[4],a[3]-1,+a[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(a){return a?Date.UTC(+a[4],a[1]-1,+a[3]):NaN}},"dd/mm/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(a){if(!a)return NaN;let b=+a[4];b=b>(new Date).getFullYear()-2E3?b+1900:b+2E3;return Date.UTC(b,a[3]-1,+a[1])},alternative:"mm/dd/YY"},
"mm/dd/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(a){return a?Date.UTC(+a[4]+2E3,a[1]-1,+a[3]):NaN}}};b=a(f.defaultOptions,b);let e=b.decimalPoint;if("."===e||","===e)this.decimalRegExp=new RegExp("^(-?[0-9]+)"+("."===e?"\\.":",")+"([0-9]+)$");this.options=b}asBoolean(a){return"boolean"===typeof a?a:"string"===typeof a?""!==a&&"0"!==a&&"false"!==a:!!this.asNumber(a)}asDate(a){if("string"===typeof a)a=this.parseDate(a);else if("number"!==typeof a){if(a instanceof
Date)return a;a=this.parseDate(this.asString(a))}return new Date(a)}asGuessedType(a){return{number:this.asNumber,Date:this.asDate,string:this.asString}[this.guessType(a)].call(this,a)}asNumber(a){if("number"===typeof a)return a;if("boolean"===typeof a)return a?1:0;if("string"===typeof a){const b=this.decimalRegExp;-1<a.indexOf(" ")&&(a=a.replace(/\s+/g,""));if(b){if(!b.test(a))return NaN;a=a.replace(b,"$1.$2")}return parseFloat(a)}return a instanceof Date?a.getDate():a?a.getRowCount():NaN}asString(a){return""+
a}deduceDateFormat(a,b,f){const e=[],k=[];let p="YYYY/mm/dd",c,g=[],d=0,h=!1,n,u;if(!b||b>a.length)b=a.length;for(;d<b;d++)if("undefined"!==typeof a[d]&&a[d]&&a[d].length)for(c=a[d].trim().replace(/[-\.\/]/g," ").split(" "),g=["","",""],u=0;u<c.length;u++)u<g.length&&(n=parseInt(c[u],10))&&(k[u]=!k[u]||k[u]<n?n:k[u],"undefined"!==typeof e[u]?e[u]!==n&&(e[u]=!1):e[u]=n,31<n?g[u]=100>n?"YY":"YYYY":12<n&&31>=n?(g[u]="dd",h=!0):g[u].length||(g[u]="mm"));if(h){for(u=0;u<e.length;u++)!1!==e[u]?12<k[u]&&
"YY"!==g[u]&&"YYYY"!==g[u]&&(g[u]="YY"):12<k[u]&&"mm"===g[u]&&(g[u]="dd");3===g.length&&"dd"===g[1]&&"dd"===g[2]&&(g[2]="YY");p=g.join("/")}f&&(this.options.dateFormat=p);return p}emit(a){g(this,a.type,a)}export(){this.emit({type:"exportError",columns:[],headers:[]});throw Error("Not implemented");}getTable(){throw Error("Not implemented");}guessType(a){var e="string";if("string"===typeof a){var f=this.trim(`${a}`),c=this.decimalRegExp;f=this.trim(f,!0);c&&(f=c.test(f)?f.replace(c,"$1.$2"):"");c=
parseFloat(f);+f===c?a=c:(e=this.parseDate(a),e=b(e)?"Date":"string")}"number"===typeof a&&(e=31536E6<a?"Date":"number");return e}on(a,b){return h(this,a,b)}parse(){this.emit({type:"parseError",columns:[],headers:[]});throw Error("Not implemented");}parseDate(a,f){var e=this.options;let k=f||e.dateFormat;f=NaN;let c,g;if(e.parseDate)f=e.parseDate(a);else{if(k)(e=this.dateFormats[k])||(e=this.dateFormats["YYYY/mm/dd"]),(g=a.match(e.regex))&&(f=e.parser(g));else for(c in this.dateFormats)if(e=this.dateFormats[c],
g=a.match(e.regex)){f=e.parser(g);break}g||(g=Date.parse(a),"object"===typeof g&&null!==g&&g.getTime?f=g.getTime()-6E4*g.getTimezoneOffset():b(g)&&(f=g-6E4*(new Date(g)).getTimezoneOffset(),-1===a.indexOf("2001")&&2001===(new Date(f)).getFullYear()&&(f=NaN)))}return f}trim(a,b){"string"===typeof a&&(a=a.replace(/^\s+|\s+$/g,""),b&&/^[0-9\s]+$/.test(a)&&(a=a.replace(/\s/g,"")));return a}}f.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,
firstRowAsNames:!0,switchRowsAndColumns:!1};(function(a){a.getTableFromColumns=function(a=[],b=[]){const e=new d;for(let f=0,k=Math.max(b.length,a.length);f<k;++f)e.setColumn(b[f]||`${f}`,a[f]);return e}})(f||(f={}));return f});l(d,"Data/DataCursor.js",[],function(){class d{constructor(c={}){this.emittingRegister=[];this.listenerMap={};this.stateMap=c}addListener(c,d,g){c=this.listenerMap[c]=this.listenerMap[c]||{};(c[d]=c[d]||[]).push(g);return this}buildEmittingTag(c){return("position"===c.cursor.type?
[c.table.id,c.cursor.column,c.cursor.row,c.cursor.state,c.cursor.type]:[c.table.id,c.cursor.columns,c.cursor.firstRow,c.cursor.lastRow,c.cursor.state,c.cursor.type]).join("\x00")}emitCursor(c,h,g,b,a){const f="object"===typeof h?h:g;g="object"===typeof b?b:g;const e="string"===typeof h?h:void 0;var k=c.id;h=f.state;if(h=this.listenerMap[k]&&this.listenerMap[k][h]){k=this.stateMap[k]=this.stateMap[k]||{};const p=k[f.state]||[];if(a||!0===b)p.length||(k[f.state]=p),-1===d.getIndex(f,p)&&p.push(f);c=
{cursor:f,cursors:p,table:c};g&&(c.event=g);e&&(c.group=e);b=this.emittingRegister;a=this.buildEmittingTag(c);if(0<=b.indexOf(a))return this;try{this.emittingRegister.push(a);for(let a=0,b=h.length;a<b;++a)h[a].call(this,c)}finally{c=this.emittingRegister.indexOf(a),0<=c&&this.emittingRegister.splice(c,1)}}return this}remitCursor(c,h){if(c=this.stateMap[c]&&this.stateMap[c][h.state])h=d.getIndex(h,c),0<=h&&c.splice(h,1);return this}removeListener(c,d,g){(c=this.listenerMap[c]&&this.listenerMap[c][d])&&
(g=c.indexOf(g))&&c.splice(g,1);return this}}(function(c){function d(c,b){var a,f,e,k;if("range"===c.type)return c;b={type:"range",firstRow:null!==(f=null!==(a=c.row)&&void 0!==a?a:b&&b.firstRow)&&void 0!==f?f:0,lastRow:null!==(k=null!==(e=c.row)&&void 0!==e?e:b&&b.lastRow)&&void 0!==k?k:Number.MAX_VALUE,state:c.state};"undefined"!==typeof c.column&&(b.columns=[c.column]);return b}c.getIndex=function(c,b){if("position"===c.type)for(let a,f=0,e=b.length;f<e;++f){if(a=b[f],"position"===a.type&&a.state===
c.state&&a.column===c.column&&a.row===c.row)return f}else{const a=JSON.stringify(c.columns);for(let f,e=0,k=b.length;e<k;++e)if(f=b[e],"range"===f.type&&f.state===c.state&&f.firstRow===c.firstRow&&f.lastRow===c.lastRow&&JSON.stringify(f.columns)===a)return e}return-1};c.isEqual=function(c,b){return"position"===c.type&&"position"===b.type?c.column===b.column&&c.row===b.row&&c.state===b.state:"range"===c.type&&"range"===b.type?c.firstRow===b.firstRow&&c.lastRow===b.lastRow&&JSON.stringify(c.columns)===
JSON.stringify(b.columns):!1};c.isInRange=function(c,b){"position"===b.type&&(b=d(b));"position"===c.type&&(c=d(c,b));const a=c.columns,f=b.columns;return c.firstRow>=b.firstRow&&c.lastRow<=b.lastRow&&(!a||!f||a.every(a=>0<=f.indexOf(a)))};c.toPositions=function(c){if("position"===c.type)return[c];const b=c.columns||[],a=[],f=c.state;for(let e=c.firstRow,k=c.lastRow;e<k;++e)if(b.length)for(let c=0,k=b.length;c<k;++c)a.push({type:"position",column:b[c],row:e,state:f});else a.push({type:"position",
row:e,state:f});return a};c.toRange=d})(d||(d={}));"";return d});l(d,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}});l(d,"Data/DataPool.js",[d["Data/Connectors/DataConnector.js"],d["Data/DataPoolDefaults.js"],d["Core/Utilities.js"]],function(d,c,h){class g{constructor(b=c){b.connectors=b.connectors||[];this.connectors={};this.options=b;this.waiting={}}emit(b){h.fireEvent(this,b.type,b)}getConnector(b){var a=this.connectors[b];if(a)return Promise.resolve(a);let f=this.waiting[b];if(f)return new Promise(a=>
{f.push(a)});this.waiting[b]=f=[];if(a=this.getConnectorOptions(b))return this.loadConnector(a).then(a=>{delete this.waiting[b];window.setTimeout(()=>{for(let b=0,e=f.length;b<e;++b)f[b](a)},1);return a});throw Error(`Connector not found. (${b})`);}getConnectorIds(){const b=this.options.connectors,a=[];for(let f=0,e=b.length;f<e;++f)a.push(b[f].id);return a}getConnectorOptions(b){const a=this.options.connectors;for(let f=0,e=a.length;f<e;++f)if(a[f].id===b)return a[f]}getConnectorTable(b){return this.getConnector(b).then(a=>
a.table)}loadConnector(b){return new Promise((a,f)=>{this.emit({type:"load",options:b});const e=d.types[b.type];if(!e)throw Error(`Connector type not found. (${b.type})`);(new e(b.options)).load().then(e=>{this.emit({type:"afterLoad",options:b});this.connectors[b.id]=e;a(e)})["catch"](f)})}on(b,a){return h.addEvent(this,b,a)}setConnectorOptions(b){const a=this.options.connectors;this.emit({type:"setConnectorOptions",options:b});for(let f=0,e=a.length;f<e;++f)if(a[f].id===b.id){a.splice(f,1);break}a.push(b);
this.emit({type:"afterSetConnectorOptions",options:b})}}return g});l(d,"Data/Formula/FormulaParser.js",[],function(){function d(a){let b=0;for(let e=0,f=a.length,c,k=1;e<f;++e)if(c=a[e],"("===c)b||(k=e+1),++b;else if(")"===c&&(--b,!b))return a.substring(k,e);if(0<b)throw a=Error("Incomplete parantheses."),a.name="FormulaParseError",a;return""}function c(a){let b=-1;for(let e=0,f=a.length,c,k=!1;e<f;++e)if(c=a[e],"\\"===c)k=!k;else if(k)k=!1;else if('"'===c)if(0>b)b=e;else return a.substring(b+1,e);
a=Error("Incomplete string.");a.name="FormulaParseError";throw a;}function h(e,f){var c;if(c=e.match(v)){e=""===c[2]||"["===c[2][0];f=""===c[1]||"["===c[1][0];var k=""===c[4]||"["===c[4][0],d=""===c[3]||"["===c[3][0];c={type:"range",beginColumn:e?parseInt(c[2].substring(1,-1)||"0",10):parseInt(c[2],10)-1,beginRow:f?parseInt(c[1].substring(1,-1)||"0",10):parseInt(c[1],10)-1,endColumn:k?parseInt(c[4].substring(1,-1)||"0",10):parseInt(c[4],10)-1,endRow:d?parseInt(c[3].substring(1,-1)||"0",10):parseInt(c[3],
10)-1};e&&(c.beginColumnRelative=!0);f&&(c.beginRowRelative=!0);k&&(c.endColumnRelative=!0);d&&(c.endRowRelative=!0);return c}if(c=e.match(z))return e="$"!==c[1][0],f="$"!==c[2][0],k="$"!==c[3][0],d="$"!==c[4][0],c={type:"range",beginColumn:a(e?c[1]:c[1].substring(1))-1,beginRow:parseInt(f?c[2]:c[2].substring(1),10)-1,endColumn:a(k?c[3]:c[3].substring(1))-1,endRow:parseInt(d?c[4]:c[4].substring(1),10)-1},e&&(c.beginColumnRelative=!0),f&&(c.beginRowRelative=!0),k&&(c.endColumnRelative=!0),d&&(c.endRowRelative=
!0),c;c=b(e,f);return 1===c.length&&"string"!==typeof c[0]?c[0]:c}function g(a,b){const e=[],f=b?";":",";let k=0,d="";for(let p=0,g=a.length,q;p<g;++p)if(q=a[p],q===f&&!k&&d)e.push(h(d,b)),d="";else if('"'!==q||k||d)" "!==q&&(d+=q,"("===q?++k:")"===q&&--k);else{const b=c(a.substring(p));e.push(b);p+=b.length+1}!k&&d&&e.push(h(d,b));return e}function b(h,n){const z=n?k:e,v=[];var m;let r=("="===h[0]?h.substring(1):h).trim();for(;r;)if(m=r.match(y)){var w=""===m[2]||"["===m[2][0],A=""===m[1]||"["===
m[1][0],B={type:"reference",column:w?parseInt(m[2].substring(1,-1)||"0",10):parseInt(m[2],10)-1,row:A?parseInt(m[1].substring(1,-1)||"0",10):parseInt(m[1],10)-1};w&&(B.columnRelative=!0);A&&(B.rowRelative=!0);v.push(B);r=r.substring(m[0].length).trim()}else if(m=r.match(l))w="$"!==m[1][0],A="$"!==m[2][0],B={type:"reference",column:a(w?m[1]:m[1].substring(1))-1,row:parseInt(A?m[2]:m[2].substring(1),10)-1},w&&(B.columnRelative=!0),A&&(B.rowRelative=!0),v.push(B),r=r.substring(m[0].length).trim();else if(m=
r.match(q))v.push(m[0]),r=r.substring(m[0].length).trim();else if(m=r.match(f))v.push("TRUE"===m[0]),r=r.substring(m[0].length).trim();else if(m=r.match(z))v.push(parseFloat(m[0])),r=r.substring(m[0].length).trim();else if('"'===r[0])m=c(r),v.push(m.substring(1,-1)),r=r.substring(m.length+2).trim();else if(m=r.match(p))r=r.substring(m[1].length).trim(),w=d(r),v.push({type:"function",name:m[1],args:g(w,n)}),r=r.substring(w.length+2).trim();else{if("("===r[0]&&(m=d(r))){v.push(b(m,n));r=r.substring(m.length+
2).trim();continue}n=h.length-r.length;h=Error("Unexpected character `"+h.substring(n,n+1)+"` at position "+(n+1)+". (`..."+h.substring(n-5,n+6)+"...`)");h.name="FormulaParseError";throw h;}return v}function a(a){let b=0;for(let e=0,c=a.length,f,k=a.length-1;e<c;++e)f=a.charCodeAt(e),65<=f&&90>=f&&(b+=(f-64)*Math.pow(26,k)),--k;return b}const f=/^(?:FALSE|TRUE)/,e=/^[+-]?\d+(?:\.\d+)?(?:e[+-]\d+)?/,k=/^[+-]?\d+(?:,\d+)?(?:e[+-]\d+)?/,p=/^([A-Z][A-Z\d\.]*)\(/,q=/^(?:[+\-*\/^<=>]|<=|=>)/,z=/^(\$?[A-Z]+)(\$?\d+):(\$?[A-Z]+)(\$?\d+)/,
v=/^R(\d*|\[\d+\])C(\d*|\[\d+\]):R(\d*|\[\d+\])C(\d*|\[\d+\])/,l=/^(\$?[A-Z]+)(\$?\d+)(?![:C])/,y=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!:)/;return{parseFormula:b}});l(d,"Data/Formula/FormulaTypes.js",[],function(){const d="+ - * / ^ = < <= > >=".split(" ");return{isFormula:function(c){return c instanceof Array},isFunction:function(c){return"object"===typeof c&&!(c instanceof Array)&&"function"===c.type},isOperator:function(c){return"string"===typeof c&&0<=d.indexOf(c)},isRange:function(c){return"object"===
typeof c&&!(c instanceof Array)&&"range"===c.type},isReference:function(c){return"object"===typeof c&&!(c instanceof Array)&&"reference"===c.type},isValue:function(c){return"boolean"===typeof c||"number"===typeof c||"string"===typeof c}}});l(d,"Data/Formula/FormulaProcessor.js",[d["Data/Formula/FormulaTypes.js"]],function(d){function c(a){switch(typeof a){case "boolean":return a?E:u;case "string":return C;case "number":return a;default:return NaN}}function h(a){return"string"===typeof a?a.toLowerCase().replace(l,
"\x00"):a}function g(a){switch(typeof a){case "boolean":return a?1:0;case "string":return parseFloat(a.replace(",","."));case "number":return a;default:return NaN}}function b(a,b,e){switch(a){case "=":return h(b)===h(e);case "<":return typeof b===typeof e?h(b)<h(e):c(b)<c(e);case "<=":return typeof b===typeof e?h(b)<=h(e):c(b)<=c(e);case ">":return typeof b===typeof e?h(b)>h(e):c(b)>c(e);case ">=":return typeof b===typeof e?h(b)>=h(e):c(b)>=c(e)}b=g(b);e=g(e);switch(a){case "+":a=b+e;break;case "-":a=
b-e;break;case "*":a=b*e;break;case "/":a=b/e;break;case "^":a=Math.pow(b,e);break;default:return NaN}return a%1?Math.round(1E9*a)/1E9:a}function a(a,b){return r(a)?a:y(a)?b&&f(a,b)||[]:v(a)?p(a,b):k(n(a)?a:[a],b)}function f(a,b){const e=b.getColumnNames().slice(a.beginColumn,a.endColumn+1),c=[];for(let f=0,k=e.length,d;f<k;++f){const k=b.getColumn(e[f],!0)||[];for(let p=a.beginRow,g=a.endRow+1;p<g;++p)d=k[p],"string"===typeof d&&"="===d[0]&&b!==b.modified&&(d=b.modified.getCell(e[f],p)),c.push(r(d)?
d:NaN)}return c}function e(a,b){const e=b.getColumnNames()[a.column];if(e){const f=b.getCell(e,a.row);return"string"===typeof f&&"="===f[0]&&b!==b.modified?(a=b.modified.getCell(e,a.row),r(a)?a:NaN):r(f)?f:NaN}return NaN}function k(a,f){let c;for(let d=0,g=a.length,q,h,z,l;d<g;++d)if(q=a[d],w(q))h=q;else if(r(q)?l=q:n(q)?l=k(a,f):v(q)?(z=p(q,f),l=r(z)?z:NaN):m(q)&&(l=f&&e(q,f)),"undefined"!==typeof l){if("undefined"===typeof c)c=h?b(h,0,l):l;else if(h){const e=a[d+1];w(e)&&D[e]>D[h]&&(l=b(e,l,k(a.slice(d+
2))),d=g);c=b(h,c,l)}else return NaN;l=h=void 0}return r(c)?c:NaN}function p(a,b){const e=A[a.name];if(e)try{return e(a.args,b)}catch(F){return NaN}a=Error(`Function "${a.name}" not found.`);a.name="FormulaProcessError";throw a;}function q(a,b=0,e=0){for(let f=0,c=a.length,k;f<c;++f)k=a[f],k instanceof Array?q(k):v(k)?q(k.args):y(k)?(k.beginColumnRelative&&(k.beginColumn+=b),k.beginRowRelative&&(k.beginRow+=e),k.endColumnRelative&&(k.endColumn+=b),k.endRowRelative&&(k.endRow+=e)):m(k)&&(k.columnRelative&&
(k.column+=b),k.rowRelative&&(k.row+=e));return a}const {isFormula:n,isFunction:v,isOperator:w,isRange:y,isReference:m,isValue:r}=d,l=/ */,u=Number.MAX_VALUE/1.000000000001,C=Number.MAX_VALUE/1.000000000002,E=Number.MAX_VALUE,D={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},A={},B=/^[A-Z][A-Z\.]*$/;return{asNumber:g,getArgumentValue:a,getArgumentsValues:function(b,e){const f=[];for(let c=0,k=b.length;c<k;++c)f.push(a(b[c],e));return f},getRangeValues:f,getReferenceValue:e,processFormula:k,
processorFunctions:A,registerProcessorFunction:function(a,b){return B.test(a)&&!A[a]&&!!(A[a]=b)},translateReferences:q}});l(d,"Data/Formula/Functions/ABS.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(c,b){c=h(c[0],b);switch(typeof c){case "number":return Math.abs(c);case "object":b=[];for(let a=0,f=c.length,e;a<f;++a){e=c[a];if("number"!==typeof e)return NaN;b.push(Math.abs(e))}return b;default:return NaN}}const {getArgumentValue:h}=d;d.registerProcessorFunction("ABS",c);return c});
l(d,"Data/Formula/Functions/AND.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(d,b){for(let a=0,f=d.length,e;a<f;++a)if(e=h(d[a],b),!e||"object"===typeof e&&!c(e,b))return!1;return!0}const {getArgumentValue:h}=d;d.registerProcessorFunction("AND",c);return c});l(d,"Data/Formula/Functions/AVERAGE.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(c,b){c=h(c,b);let a=b=0;for(let f=0,e=c.length,k;f<e;++f)switch(k=c[f],typeof k){case "number":isNaN(k)||(++b,a+=k);break;
case "object":for(let e=0,c=k.length,f;e<c;++e)f=k[e],"number"!==typeof f||isNaN(f)||(++b,a+=f)}return b?a/b:0}const {getArgumentsValues:h}=d;d.registerProcessorFunction("AVERAGE",c);return c});l(d,"Data/Formula/Functions/AVERAGEA.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(c,b){let a=0,f=0;for(let e=0,k=c.length,d;e<k;++e)switch(d=h(c[e],b),typeof d){case "boolean":++a;f+=d?1:0;continue;case "number":isNaN(d)||(++a,f+=d);continue;case "string":++a;continue;default:for(let b=
0,e=d.length,c;b<e;++b)switch(c=d[b],typeof c){case "boolean":++a;f+=c?1:0;continue;case "number":isNaN(c)||(++a,f+=c);continue;case "string":++a}}return a?f/a:0}const {getArgumentValue:h}=d;d.registerProcessorFunction("AVERAGEA",c);return c});l(d,"Data/Formula/Functions/COUNT.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(h,g){h=d.getArgumentsValues(h,g);let b=0;for(let a=0,f=h.length,e;a<f;++a)switch(e=h[a],typeof e){case "number":isNaN(e)||++b;break;case "object":b+=c(e,g)}return b}
d.registerProcessorFunction("COUNT",c);return c});l(d,"Data/Formula/Functions/COUNTA.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(h,g){h=d.getArgumentsValues(h,g);let b=0;for(let a=0,f=h.length,e;a<f;++a){e=h[a];switch(typeof e){case "number":if(isNaN(e))continue;break;case "object":b+=c(e,g);continue;case "string":if(!e)continue}++b}return b}d.registerProcessorFunction("COUNTA",c);return c});l(d,"Data/Formula/Functions/IF.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(c,
b){return h(c[0],b)?h(c[1],b):h(c[2],b)}const {getArgumentValue:h}=d;d.registerProcessorFunction("IF",c);return c});l(d,"Data/Formula/Functions/ISNA.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(c,b){c=h(c[0],b);return"number"!==typeof c||isNaN(c)}const {getArgumentValue:h}=d;d.registerProcessorFunction("ISNA",c);return c});l(d,"Data/Formula/Functions/MAX.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(d,b){d=h(d,b);b=Number.NEGATIVE_INFINITY;for(let a=0,f=
d.length,e;a<f;++a)switch(e=d[a],typeof e){case "number":e>b&&(b=e);break;case "object":e=c(e),e>b&&(b=e)}return isFinite(b)?b:0}const {getArgumentsValues:h}=d;d.registerProcessorFunction("MAX",c);return c});l(d,"Data/Formula/Functions/MEDIAN.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(c,g){const b=[];c=d.getArgumentsValues(c,g);for(let a=0,f=c.length,e;a<f;++a)switch(e=c[a],typeof e){case "number":isNaN(e)||b.push(e);break;case "object":for(let a=0,c=e.length,f;a<c;++a)f=e[a],
"number"!==typeof f||isNaN(f)||b.push(f)}c=b.length;if(!c)return NaN;g=Math.floor(c/2);return c%2?b[g]:(b[g-1]+b[g])/2}d.registerProcessorFunction("MEDIAN",c);return c});l(d,"Data/Formula/Functions/MIN.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(d,b){d=h(d,b);b=Number.POSITIVE_INFINITY;for(let a=0,f=d.length,e;a<f;++a)switch(e=d[a],typeof e){case "number":e<b&&(b=e);break;case "object":e=c(e),e<b&&(b=e)}return isFinite(b)?b:0}const {getArgumentsValues:h}=d;d.registerProcessorFunction("MIN",
c);return c});l(d,"Data/Formula/Functions/MOD.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(c,b){let a=h(c[0],b);c=h(c[1],b);"object"===typeof a&&(a=a[0]);"object"===typeof c&&(c=c[0]);return"number"!==typeof a||"number"!==typeof c||0===c?NaN:a%c}const {getArgumentValue:h}=d;d.registerProcessorFunction("MOD",c);return c});l(d,"Data/Formula/Functions/MODE.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(b,a){const c={};b=d.getArgumentsValues(b,a);for(let a=0,
f=b.length,d;a<f;++a)switch(d=b[a],typeof d){case "number":isNaN(d)||(c[d]=(c[d]||0)+1);break;case "object":for(let a=0,b=d.length,e;a<b;++a)e=d[a],"number"!==typeof e||isNaN(e)||(c[e]=(c[e]||0)+1)}return c}function h(b,a){b=c(b,a);a=Object.keys(b);if(!a.length)return NaN;let f=[parseFloat(a[0])],e=b[a[0]];for(let c=1,d=a.length,g,h;c<d;++c)g=a[c],h=b[g],e<h?(f=[parseFloat(g)],e=h):e===h&&f.push(parseFloat(g));return 1<e?f:NaN}function g(b,a){b=c(b,a);a=Object.keys(b);if(!a.length)return NaN;let f=
parseFloat(a[0]),e=b[a[0]];for(let c=1,d=a.length,g,h,v;c<d;++c)g=a[c],v=b[g],e<v?(f=parseFloat(g),e=v):e===v&&(h=parseFloat(g),f>h&&(f=h,e=v));return 1<e?f:NaN}d.registerProcessorFunction("MODE",g);d.registerProcessorFunction("MODE.MULT",h);d.registerProcessorFunction("MODE.SNGL",g);return{MULT:h,SNGL:g}});l(d,"Data/Formula/Functions/NOT.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(c,b){c=h(c[0],b);"object"===typeof c&&(c=c[0]);switch(typeof c){case "boolean":case "number":return!c}return NaN}
const {getArgumentValue:h}=d;d.registerProcessorFunction("NOT",c);return c});l(d,"Data/Formula/Functions/OR.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(d,b){for(let a=0,f=d.length,e;a<f;++a)if(e=h(d[a],b),"object"===typeof e){if(c(e,b))return!0}else if(e)return!0;return!1}const {getArgumentValue:h}=d;d.registerProcessorFunction("OR",c);return c});l(d,"Data/Formula/Functions/PRODUCT.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(d,b){d=h(d,b);let a=1,f=!1;
for(let e=0,k=d.length,p;e<k;++e)switch(p=d[e],typeof p){case "number":isNaN(p)||(f=!0,a*=p);break;case "object":f=!0,a*=c(p,b)}return f?a:0}const {getArgumentsValues:h}=d;d.registerProcessorFunction("PRODUCT",c);return c});l(d,"Data/Formula/Functions/SUM.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(h,g){h=d.getArgumentsValues(h,g);let b=0;for(let a=0,f=h.length,e;a<f;++a)switch(e=h[a],typeof e){case "number":isNaN(e)||(b+=e);break;case "object":b+=c(e,g)}return b}d.registerProcessorFunction("SUM",
c);return c});l(d,"Data/Formula/Functions/XOR.js",[d["Data/Formula/FormulaProcessor.js"]],function(d){function c(c,b){for(let a=0,f=c.length,e,d;a<f;++a)switch(d=h(c[a],b),typeof d){case "boolean":case "number":if("undefined"===typeof e)e=!!d;else if(!!d!==e)return!0;break;case "object":for(let a=0,b=d.length,c;a<b;++a)switch(c=d[a],typeof c){case "boolean":case "number":if("undefined"===typeof e)e=!!c;else if(!!c!==e)return!0}}return!1}const {getArgumentValue:h}=d;d.registerProcessorFunction("XOR",
c);return c});l(d,"Data/Formula/Formula.js",[d["Data/Formula/FormulaParser.js"],d["Data/Formula/FormulaProcessor.js"],d["Data/Formula/FormulaTypes.js"]],function(d,c,h){return Object.assign(Object.assign(Object.assign({},d),c),h)});l(d,"Data/Converters/CSVConverter.js",[d["Data/Converters/DataConverter.js"],d["Core/Utilities.js"]],function(d,c){const {merge:h}=c;class g extends d{constructor(b){b=h(g.defaultOptions,b);super(b);this.columns=[];this.headers=[];this.dataTypes=[];this.options=b}export(b,
a=this.options){const {useLocalDecimalPoint:c,lineDelimiter:e}=a;var d=!1!==this.options.firstRowAsNames;let {decimalPoint:p,itemDelimiter:g}=a;p||(p=","!==g&&c?(1.1).toLocaleString()[1]:".");g||(g=","===p?";":",");a=b.getSortedColumns(a.usePresentationOrder);const h=Object.keys(a),v=[],l=h.length,n=[];d&&v.push(h.map(a=>`"${a}"`).join(g));for(d=0;d<l;d++){var m=h[d];const e=a[m],c=e.length;m=b.whatIs(m);let f;m&&(f=m.dataType);for(m=0;m<c;m++){var r=e[m];n[m]||(n[m]=[]);"string"===f?r='"'+r+'"':
"number"===typeof r?r=String(r).replace(".",p):"string"===typeof r&&(r=`"${r}"`);n[m][d]=r;if(d===l-1){for(r=d;2<n[m].length&&void 0===n[m][r];)n[m].pop(),r--;v.push(n[m].join(g))}}}return v.join(e)}parse(b,a){var c=this.dataTypes;b=h(this.options,b);const {beforeParse:e,lineDelimiter:d,firstRowAsNames:p,itemDelimiter:g}=b;let {csv:z,startRow:v,endRow:n}=b;this.columns=[];this.emit({type:"parse",columns:this.columns,detail:a,headers:this.headers});z&&e&&(z=e(z));if(z){b=z.replace(/\r\n|\r/g,"\n").split(d||
"\n");if(!v||0>v)v=0;if(!n||n>=b.length)n=b.length-1;g||(this.guessedItemDelimiter=this.guessDelimiter(b));if(p){var l=b[0].split(g||this.guessedItemDelimiter||",");for(var m=0;m<l.length;m++)l[m]=l[m].trim().replace(/^["']|["']$/g,"");this.headers=l;v++}m=0;for(l=v;l<=n;l++)"#"===b[l][0]?m++:this.parseCSVRow(b[l],l-v-m);c.length&&c[0].length&&"date"===c[0][1]&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);for(let a=0,e=this.columns.length;a<e;++a){c=this.columns[a];for(let e=
0,d=c.length;e<d;++e)c[e]&&"string"===typeof c[e]&&(b=this.asGuessedType(c[e]),b instanceof Date&&(b=b.getTime()),this.columns[a][e]=b)}}this.emit({type:"afterParse",columns:this.columns,detail:a,headers:this.headers})}parseCSVRow(b,a){const c=this,e=c.columns||[],d=c.dataTypes,{startColumn:p,endColumn:g}=c.options,h=c.options.itemDelimiter||c.guessedItemDelimiter;let {decimalPoint:v}=c.options;v&&v!==h||(v=c.guessedDecimalPoint||".");let l=0,n="",m="",r=0,x=0;const u=a=>{d.length<x+1&&d.push([a]);
d[x][d[x].length-1]!==a&&d[x].push(a)},C=()=>{if(p>r||r>g)++r,m="";else{"string"===typeof m?!isNaN(parseFloat(m))&&isFinite(m)?(m=parseFloat(m),u("number")):isNaN(Date.parse(m))?u("string"):(m=m.replace(/\//g,"-"),u("date")):u("number");e.length<x+1&&e.push([]);if("number"!==typeof m&&"number"!==c.guessType(m)&&v){const a=m;m=m.replace(v,".");"number"!==c.guessType(m)&&(m=a)}e[x][a]=m;m="";++x;++r}};if(b.trim().length&&"#"!==b.trim()[0]){for(;l<b.length;l++){n=b[l];if("#"===n&&!/^#[0-F]{3,3}|[0-F]{6,6}/i.test(b.substring(l))){C();
return}if('"'===n)for(n=b[++l];l<b.length&&'"'!==n;)m+=n,n=b[++l];else n===h?C():m+=n}C()}}guessDelimiter(b){let a=0,c=0;const e={",":0,";":0,"\t":0},d=b.length;for(let f=0;f<d;f++){let d=!1,k,p,g,h="";if(13<f)break;const m=b[f];for(let b=0;b<m.length;b++){k=m[b];p=m[b+1];g=m[b-1];if("#"===k)break;if('"'===k)if(d){if('"'!==g&&'"'!==p){for(;" "===p&&b<m.length;)p=m[++b];"undefined"!==typeof e[p]&&e[p]++;d=!1}}else d=!0;else"undefined"!==typeof e[k]?(h=h.trim(),isNaN(Date.parse(h))?!isNaN(Number(h))&&
isFinite(Number(h))||e[k]++:e[k]++,h=""):h+=k;","===k&&c++;"."===k&&a++}}b=e[";"]>e[","]?";":",";this.guessedDecimalPoint=a>c?".":",";return b}getTable(){return d.getTableFromColumns(this.columns,this.headers)}}g.defaultOptions=Object.assign(Object.assign({},d.defaultOptions),{lineDelimiter:"\n"});return g});l(d,"Data/Connectors/CSVConnector.js",[d["Data/Converters/CSVConverter.js"],d["Data/Connectors/DataConnector.js"],d["Core/Utilities.js"]],function(d,c,h){const {merge:g}=h;class b extends c{constructor(a){a=
g(b.defaultOptions,a);super(a);this.converter=new d(a);this.options=a;a.enablePolling&&this.startPolling(1E3*Math.max(a.dataRefreshRate||0,1))}load(a){const b=this,e=b.converter,c=b.table,{csv:d,csvURL:g,dataModifier:h}=b.options;b.emit({type:"load",csv:d,detail:a,table:c});c.deleteRows();return Promise.resolve(d?d:g?fetch(g||"").then(a=>a.text()):"").then(a=>{a&&(e.parse({csv:a}),c.setColumns(e.getTable().getColumns()));return b.setModifierOptions(h).then(()=>a)}).then(e=>{b.emit({type:"afterLoad",
csv:e,detail:a,table:c});return b})["catch"](e=>{b.emit({type:"loadError",detail:a,error:e,table:c});throw e;})}}b.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0};c.registerType("CSV",b);return b});l(d,"Data/Converters/GoogleSheetsConverter.js",[d["Data/Converters/DataConverter.js"],d["Core/Utilities.js"]],function(d,c){const {merge:h,uniqueKey:g}=c;class b extends d{constructor(a){a=h(b.defaultOptions,a);super(a);this.columns=[];this.header=[];this.options=
a}parse(a,b){a=h(this.options,a);const e=(a.json&&a.json.values||[]).map(a=>a.slice());if(0===e.length)return!1;this.header=[];this.columns=[];this.emit({type:"parse",columns:this.columns,detail:b,headers:this.header});this.columns=e;let c;for(let b=0,d=e.length;b<d;b++){c=e[b];this.header[b]=a.firstRowAsNames?`${c.shift()}`:g();for(let a=0,e=c.length;a<e;++a)if(c[a]&&"string"===typeof c[a]){let e=this.asGuessedType(c[a]);e instanceof Date&&(e=e.getTime());this.columns[b][a]=e}}this.emit({type:"afterParse",
columns:this.columns,detail:b,headers:this.header})}getTable(){return d.getTableFromColumns(this.columns,this.header)}}b.defaultOptions=Object.assign({},d.defaultOptions);return b});l(d,"Data/Connectors/GoogleSheetsConnector.js",[d["Data/Connectors/DataConnector.js"],d["Data/Converters/GoogleSheetsConverter.js"],d["Core/Utilities.js"]],function(d,c,h){const {merge:g,pick:b}=h;class a extends d{constructor(b){b=g(a.defaultOptions,b);super(b);this.converter=new c(b);this.options=b}load(b){const e=this,
c=e.converter,d=e.table,{dataModifier:f,dataRefreshRate:g,enablePolling:h,firstRowAsNames:l,googleAPIKey:n,googleSpreadsheetKey:m}=e.options,r=a.buildFetchURL(n,m,e.options);e.emit({type:"load",detail:b,table:d,url:r});d.deleteColumns();return fetch(r).then(a=>a.json()).then(a=>{if("object"===typeof a&&a&&"object"===typeof a.error&&a.error&&"number"===typeof a.error.code&&"string"===typeof a.error.message&&"string"===typeof a.error.status)throw Error(a.error.message);c.parse({firstRowAsNames:l,json:a});
d.setColumns(c.getTable().getColumns());return e.setModifierOptions(f)}).then(()=>{e.emit({type:"afterLoad",detail:b,table:d,url:r});h&&setTimeout(()=>e.load(),1E3*Math.max(g||0,1));return e})["catch"](a=>{e.emit({type:"loadError",detail:b,error:a,table:d});throw a;})}}a.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};(function(a){function e(a={}){const {endColumn:e,endRow:c,googleSpreadsheetRange:d,startColumn:f,startRow:k}=
a;return d||("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[f||0]||"A")+(Math.max(k||0,0)+1)+":"+("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[b(e,25)]||"Z")+(c?Math.max(c,0):"Z")}a.buildFetchURL=function(a,b,c={}){return`https://sheets.googleapis.com/v4/spreadsheets/${b}/values/`+(c.onlyColumnNames?"A1:Z1":e(c))+"?alt=json"+(c.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+"&prettyPrint=false"+`&key=${a}`};a.buildQueryRange=e})(a||(a={}));d.registerType("GoogleSheets",
a);return a});l(d,"Data/Converters/HTMLTableConverter.js",[d["Data/Converters/DataConverter.js"],d["Core/Utilities.js"]],function(d,c){const {merge:h}=c;class g extends d{constructor(b){b=h(g.defaultOptions,b);super(b);this.columns=[];this.headers=[];this.options=b;b.tableElement&&(this.tableElement=b.tableElement,this.tableElementID=b.tableElement.id)}export(b,a=this.options){var c=!1!==a.firstRowAsNames,e=a.useMultiLevelHeaders,d=b.getSortedColumns(a.usePresentationOrder);const g=Object.keys(d);
b=[];const h=g.length,l=[];var n="";if(c)if(n=[],e){for(var w of g)e=(d[w].shift()||"").toString(),n.push(e);n=this.getTableHeaderHTML(g,n,a)}else n=this.getTableHeaderHTML(void 0,g,a);for(w=0;w<h;w++){e=d[g[w]];c=e.length;for(let a=0;a<c;a++){let c=e[a];l[a]||(l[a]=[]);"string"!==typeof c&&"number"!==typeof c&&"undefined"!==typeof c&&(c=(c||"").toString());l[a][w]=this.getCellHTMLFromValue(w?"td":"th",null,w?"":'scope="row"',c);w===h-1&&b.push("<tr>"+l[a].join("")+"</tr>")}}d="";a.tableCaption&&
(d='<caption class="highcharts-table-caption">'+a.tableCaption+"</caption>");return"<table>"+d+n+"<tbody>"+b.join("")+"</tbody></table>"}getCellHTMLFromValue(b,a,c,e,d){let f=e;a="text"+(a?" "+a:"");"number"===typeof f?(f=f.toString(),","===d&&(f=f.replace(".",d)),a="number"):e||(f="",a="empty");return"<"+b+(c?" "+c:"")+' class="'+a+'">'+f+"</"+b+">"}getTableHeaderHTML(b=[],a=[],c=this.options){const {useMultiLevelHeaders:e,useRowspanHeaders:d}=c;c.useLocalDecimalPoint&&(1.1).toLocaleString();c="<thead>";
let f=0,g=a&&a.length;var h;let l=0;if(h=e&&b&&a){a:if(h=b.length,a.length===h){for(;--h;)if(b[h]!==a[h]){h=!1;break a}h=!0}else h=!1;h=!h}if(h){for(c+="<tr>";f<g;++f){h=b[f];var n=b[f+1];h===n?++l:l?(c+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(l+1)+'"',h),l=0):(h===a[f]?d?(n=2,delete a[f]):(n=1,a[f]=""):n=1,c+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<n?' valign="top" rowspan="'+n+'"':""),h))}c+="</tr>"}if(a){c+="<tr>";
f=0;for(g=a.length;f<g;++f)"undefined"!==typeof a[f]&&(c+=this.getCellHTMLFromValue("th",null,'scope="col"',a[f]));c+="</tr>"}return c+"</thead>"}parse(b,a){const c=[],e=[];var d=h(this.options,b);const {endRow:g,startColumn:q,endColumn:l,firstRowAsNames:n}=d;b=d.tableElement||this.tableElement;if(b instanceof HTMLElement){this.tableElement=b;this.tableElementID=b.id;this.emit({type:"parse",columns:this.columns,detail:a,headers:this.headers});b=b.getElementsByTagName("tr");var w=b.length,y=0;({startRow:d}=
d);if(n&&w){var m=b[0].children,r=m.length;for(var x=q;x<r&&!(x>l);x++){var u=m[x];"TD"!==u.tagName&&"TH"!==u.tagName||e.push(u.innerHTML)}d++}for(;y<w;){if(y>=d&&y<=g)for(m=b[y].children,r=m.length,x=0;x<r;){const a=x-q,b=c[a];u=m[x];if(("TD"===u.tagName||"TH"===u.tagName)&&x>=q&&x<=l)for(c[a]||(c[a]=[]),u=this.asGuessedType(u.innerHTML),u instanceof Date&&(u=u.getTime()),c[a][y-d]=u,u=1;y-d>=u&&void 0===b[y-d-u];)b[y-d-u]=null,u++;x++}y++}this.columns=c;this.headers=e;this.emit({type:"afterParse",
columns:c,detail:a,headers:e})}else this.emit({type:"parseError",columns:c,detail:a,headers:e,error:"Not a valid HTML Table"})}getTable(){return d.getTableFromColumns(this.columns,this.headers)}}g.defaultOptions=Object.assign(Object.assign({},d.defaultOptions),{useRowspanHeaders:!0,useMultiLevelHeaders:!0});return g});l(d,"Data/Connectors/HTMLTableConnector.js",[d["Data/Connectors/DataConnector.js"],d["Core/Globals.js"],d["Data/Converters/HTMLTableConverter.js"],d["Core/Utilities.js"]],function(d,
c,h,g){const {win:b}=c,{merge:a}=g;class f extends d{constructor(b){b=a(f.defaultOptions,b);super(b);this.converter=new h(b);this.options=b}load(c){const e=this,d=e.converter,f=e.table,{dataModifier:g,table:h}=e.options;e.emit({type:"load",detail:c,table:f,tableElement:e.tableElement});f.deleteColumns();let l;"string"===typeof h?(e.tableID=h,l=b.document.getElementById(h)):(l=h,e.tableID=l.id);e.tableElement=l||void 0;if(!e.tableElement)return e.emit({type:"loadError",detail:c,error:"HTML table not provided, or element with ID not found",
table:f}),Promise.reject(Error("HTML table not provided, or element with ID not found"));d.parse(a({tableElement:e.tableElement},e.options),c);f.setColumns(d.getTable().getColumns());return e.setModifierOptions(g).then(()=>{e.emit({type:"afterLoad",detail:c,table:f,tableElement:e.tableElement});return e})}}f.defaultOptions={table:""};d.registerType("HTMLTable",f);return f});l(d,"Data/Modifiers/ChainModifier.js",[d["Data/Modifiers/DataModifier.js"],d["Core/Utilities.js"]],function(d,c){const {merge:h}=
c;class g extends d{constructor(b,...a){super();this.chain=a;this.options=h(g.defaultOptions,b);b=this.options.chain||[];for(let c=0,e=b.length,k,g;c<e;++c)k=b[c],k.type&&(g=d.types[k.type])&&a.push(new g(k))}add(b,a){this.emit({type:"addModifier",detail:a,modifier:b});this.chain.push(b);this.emit({type:"addModifier",detail:a,modifier:b})}clear(b){this.emit({type:"clearChain",detail:b});this.chain.length=0;this.emit({type:"afterClearChain",detail:b})}modify(b,a){const c=this.options.reverse?this.chain.slice().reverse():
this.chain.slice();b.modified===b&&(b.modified=b.clone(!1,a));let e=Promise.resolve(b);for(let b=0,d=c.length;b<d;++b){const d=c[b];e=e.then(b=>d.modify(b.modified,a))}e=e.then(a=>{b.modified.deleteColumns();b.modified.setColumns(a.modified.getColumns());return b});return e=e["catch"](c=>{this.emit({type:"error",detail:a,table:b});throw c;})}modifyCell(b,a,c,e,d){const f=this.options.reverse?this.chain.reverse():this.chain;if(f.length){let k=b.clone();for(let b=0,g=f.length;b<g;++b)f[b].modifyCell(k,
a,c,e,d),k=k.modified;b.modified=k}return b}modifyColumns(b,a,c,e){const d=this.options.reverse?this.chain.reverse():this.chain.slice();if(d.length){let f=b.clone();for(let b=0,k=d.length;b<k;++b)d[b].modifyColumns(f,a,c,e),f=f.modified;b.modified=f}return b}modifyRows(b,a,c,e){const d=this.options.reverse?this.chain.reverse():this.chain.slice();if(d.length){let f=b.clone();for(let b=0,k=d.length;b<k;++b)d[b].modifyRows(f,a,c,e),f=f.modified;b.modified=f}return b}modifyTable(b,a){this.emit({type:"modify",
detail:a,table:b});const c=this.options.reverse?this.chain.reverse():this.chain.slice();let e=b.modified;for(let b=0,d=c.length,f;b<d;++b)f=c[b],e=f.modifyTable(e,a).modified;b.modified=e;this.emit({type:"afterModify",detail:a,table:b});return b}remove(b,a){const c=this.chain;this.emit({type:"removeModifier",detail:a,modifier:b});c.splice(c.indexOf(b),1);this.emit({type:"afterRemoveModifier",detail:a,modifier:b})}}g.defaultOptions={type:"Chain"};d.registerType("Chain",g);return g});l(d,"Data/Modifiers/InvertModifier.js",
[d["Data/Modifiers/DataModifier.js"],d["Core/Utilities.js"]],function(d,c){const {merge:h}=c;class g extends d{constructor(b){super();this.options=h(g.defaultOptions,b)}modifyCell(b,a,c,e,d){const f=b.modified;a=f.getRowIndexBy("columnNames",a);"undefined"===typeof a?f.setColumns(this.modifyTable(b.clone()).getColumns(),void 0,d):f.setCell(`${c}`,a,e,d);return b}modifyColumns(b,a,c,e){const d=b.modified,f=d.getColumn("columnNames")||[];let g=b.getColumnNames(),h=b.getRowCount()!==f.length;if(!h)for(let a=
0,b=g.length;a<b;++a)if(g[a]!==f[a]){h=!0;break}if(h)return this.modifyTable(b,e);g=Object.keys(a);for(let b=0,f=g.length,k,h,p;b<f;++b){h=g[b];k=a[h];p=d.getRowIndexBy("columnNames",h)||d.getRowCount();for(let a=0,b=c,f=k.length;a<f;++a,++b)d.setCell(`${b}`,p,k[a],e)}return b}modifyRows(b,a,c,e){const d=b.getColumnNames(),f=b.modified,g=f.getColumn("columnNames")||[];let h=b.getRowCount()!==g.length;if(!h)for(let a=0,b=d.length;a<b;++a)if(d[a]!==g[a]){h=!0;break}if(h)return this.modifyTable(b,e);
for(let b=0,g=c,h=a.length,k;b<h;++b,++g)if(k=a[b],k instanceof Array)f.setColumn(`${g}`,k);else for(let a=0,b=d.length;a<b;++a)f.setCell(`${g}`,a,k[d[a]],e);return b}modifyTable(b,a){this.emit({type:"modify",detail:a,table:b});const c=b.modified;if(b.hasColumns(["columnNames"])){var e=((b.deleteColumns(["columnNames"])||{}).columnNames||[]).map(a=>`${a}`);const a={};for(let c=0,d=b.getRowCount(),f;c<d;++c)(f=b.getRow(c))&&(a[e[c]]=f);c.deleteColumns();c.setColumns(a)}else{e={};for(let a=0,c=b.getRowCount(),
d;a<c;++a)(d=b.getRow(a))&&(e[`${a}`]=d);e.columnNames=b.getColumnNames();c.deleteColumns();c.setColumns(e)}this.emit({type:"afterModify",detail:a,table:b});return b}}g.defaultOptions={type:"Invert"};d.registerType("Invert",g);return g});l(d,"Data/Modifiers/MathModifier.js",[d["Data/Modifiers/DataModifier.js"],d["Data/Formula/FormulaParser.js"],d["Data/Formula/FormulaProcessor.js"]],function(d,c,h){class g extends d{constructor(b){super();this.options=Object.assign(Object.assign({},g.defaultOptions),
b)}modifyTable(b,a){this.emit({type:"modify",detail:a,table:b});const d=this.options.alternativeSeparators;var e=this.options.formulaColumns||b.getColumnNames();const g=b.modified;for(let a=0,c=e.length,d;a<c;++a)d=e[a],0<=e.indexOf(d)&&g.setColumn(d,this.processColumn(b,d));e=this.options.columnFormulas||[];for(let a=0,f=e.length,h,k;a<f;++a)h=e[a],k=c.parseFormula(h.formula,d),g.setColumn(h.column,this.processColumnFormula(k,b,h.rowStart,h.rowEnd));this.emit({type:"afterModify",detail:a,table:b});
return b}processColumn(b,a,d=0){const e=this.options.alternativeSeparators;a=(b.getColumn(a,!0)||[]).slice(0<d?d:0);for(let d=0,f=a.length,g=[],l="",n;d<f;++d)if(n=a[d],"string"===typeof n&&"="===n[0])try{g=l===n?g:c.parseFormula(n.substring(1),e),a[d]=h.processFormula(g,b)}catch(w){a[d]=NaN}return a}processColumnFormula(b,a,c=0,e=a.getRowCount()){c=0<=c?c:0;e=0<=e?e:a.getRowCount()+e;const d=[];a=a.modified;for(let f=0,g=e-c;f<g;++f)try{d[f]=h.processFormula(b,a)}catch(z){d[f]=NaN}finally{b=h.translateReferences(b,
0,1)}return d}}g.defaultOptions={type:"Math",alternativeSeparators:!1};d.registerType("Math",g);return g});l(d,"Data/Modifiers/RangeModifier.js",[d["Data/Modifiers/DataModifier.js"],d["Core/Utilities.js"]],function(d,c){const {merge:h}=c;class g extends d{constructor(b){super();this.options=h(g.defaultOptions,b)}modifyTable(b,a){this.emit({type:"modify",detail:a,table:b});const {additive:c,ranges:e,strict:d}=this.options;if(e.length){const a=b.modified;let f=b.getColumns(),g=[];for(let h=0,k=e.length,
l,m;h<k;++h)if(l=e[h],!d||typeof l.minValue===typeof l.maxValue){0<h&&!c&&(a.deleteRows(),a.setRows(g),f=a.getColumns(),g=[]);m=f[l.column]||[];for(let e=0,f=m.length,h,k;e<f;++e){h=m[e];switch(typeof h){default:continue;case "boolean":case "number":case "string":}(!d||typeof h===typeof l.minValue)&&h>=l.minValue&&h<=l.maxValue&&(k=c?b.getRow(e):a.getRow(e))&&g.push(k)}}a.deleteRows();a.setRows(g)}this.emit({type:"afterModify",detail:a,table:b});return b}}g.defaultOptions={type:"Range",ranges:[]};
d.registerType("Range",g);return g});l(d,"Data/Modifiers/SortModifier.js",[d["Data/Modifiers/DataModifier.js"],d["Data/DataTable.js"],d["Core/Utilities.js"]],function(d,c,h){const {merge:g}=h;class b extends d{static ascending(a,b){return(a||0)<(b||0)?-1:(a||0)>(b||0)?1:0}static descending(a,b){return(b||0)<(a||0)?-1:(b||0)>(a||0)?1:0}constructor(a){super();this.options=g(b.defaultOptions,a)}getRowReferences(a){a=a.getRows();const b=[];for(let c=0,d=a.length;c<d;++c)b.push({index:c,row:a[c]});return b}modifyCell(a,
b,e,d,g){const {orderByColumn:f,orderInColumn:h}=this.options;b===f&&(h?(a.modified.setCell(b,e,d),a.modified.setColumn(h,this.modifyTable(new c({columns:a.getColumns([f,h])})).modified.getColumn(h))):this.modifyTable(a,g));return a}modifyColumns(a,b,e,d){const {orderByColumn:f,orderInColumn:g}=this.options,h=Object.keys(b);-1<h.indexOf(f)&&(g&&b[h[0]].length?(a.modified.setColumns(b,e),a.modified.setColumn(g,this.modifyTable(new c({columns:a.getColumns([f,g])})).modified.getColumn(g))):this.modifyTable(a,
d));return a}modifyRows(a,b,e,d){const {orderByColumn:f,orderInColumn:g}=this.options;g&&b.length?(a.modified.setRows(b,e),a.modified.setColumn(g,this.modifyTable(new c({columns:a.getColumns([f,g])})).modified.getColumn(g))):this.modifyTable(a,d);return a}modifyTable(a,c){this.emit({type:"modify",detail:c,table:a});var e=a.getColumnNames();const d=a.getRowCount(),f=this.getRowReferences(a),{direction:g,orderByColumn:h,orderInColumn:l}=this.options,n="asc"===g?b.ascending:b.descending,y=e.indexOf(h);
e=a.modified;-1!==y&&f.sort((a,b)=>n(a.row[y],b.row[y]));if(l){var m=[];for(var r=0;r<d;++r)m[f[r].index]=r;e.setColumns({[l]:m})}else{m=[];for(r=0;r<d;++r)m.push(f[r].row);e.setRows(m,0)}this.emit({type:"afterModify",detail:c,table:a});return a}}b.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"};d.registerType("Sort",b);return b});l(d,"masters/modules/data-tools.src.js",[d["Core/Globals.js"],d["Data/Connectors/DataConnector.js"],d["Data/Converters/DataConverter.js"],d["Data/DataCursor.js"],
d["Data/Modifiers/DataModifier.js"],d["Data/DataPool.js"],d["Data/DataTable.js"],d["Data/Formula/Formula.js"]],function(d,c,h,g,b,a,f,e){d.DataConnector=c;d.DataConverter=h;d.DataCursor=g;d.DataModifier=b;d.DataPool=a;d.DataTable=f;d.Formula=e})});//# sourceMappingURL=data-tools.js.map