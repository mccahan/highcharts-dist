/*
 Highstock JS v11.1.0 (2023-08-20)

 Indicator series type for Highcharts Stock

 (c) 2010-2021 Pawe Dalek

 License: www.highcharts.com/license
*/
'use strict';(function(b){"object"===typeof module&&module.exports?(b["default"]=b,module.exports=b):"function"===typeof define&&define.amd?define("highcharts/indicators/volume-by-price",["highcharts","highcharts/modules/stock"],function(k){b(k);b.Highcharts=k;return b}):b("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(b){function k(b,p,w,f){b.hasOwnProperty(p)||(b[p]=f.apply(null,w),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:p,
module:b[p]}})))}b=b?b._modules:{};k(b,"Stock/Indicators/VBP/VBPPoint.js",[b["Core/Series/SeriesRegistry.js"]],function(b){var p=this&&this.__extends||function(){function b(f,a){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(b[f]=a[f])};return b(f,a)}return function(f,a){function p(){this.constructor=f}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+
" is not a constructor or null");b(f,a);f.prototype=null===a?Object.create(a):(p.prototype=a.prototype,new p)}}();return function(b){function f(){return null!==b&&b.apply(this,arguments)||this}p(f,b);f.prototype.destroy=function(){this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy());b.prototype.destroy.apply(this,arguments)};return f}(b.seriesTypes.sma.prototype.pointClass)});k(b,"Stock/Indicators/VBP/VBPIndicator.js",[b["Stock/Indicators/VBP/VBPPoint.js"],b["Core/Animation/AnimationUtilities.js"],
b["Core/Globals.js"],b["Core/Series/SeriesRegistry.js"],b["Core/Utilities.js"],b["Core/Chart/StockChart.js"]],function(b,p,k,f,a,H){var w=this&&this.__extends||function(){function b(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,b){c.__proto__=b}||function(c,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(c[d]=b[d])};return b(a,c)}return function(a,c){function n(){this.constructor=a}if("function"!==typeof c&&null!==c)throw new TypeError("Class extends value "+
String(c)+" is not a constructor or null");b(a,c);a.prototype=null===c?Object.create(c):(n.prototype=c.prototype,new n)}}(),I=p.animObject;p=k.noop;k=f.seriesTypes;var x=k.column.prototype,D=k.sma,A=a.addEvent,E=a.arrayMax,J=a.arrayMin,B=a.correctFloat,F=a.defined,C=a.error,G=a.extend,K=a.isArray,L=a.merge,u=Math.abs;a=function(b){function a(){var c=null!==b&&b.apply(this,arguments)||this;c.data=void 0;c.negWidths=void 0;c.options=void 0;c.points=void 0;c.posWidths=void 0;c.priceZones=void 0;c.rangeStep=
void 0;c.volumeDataArray=void 0;c.zoneStarts=void 0;c.zoneLinesSVG=void 0;return c}w(a,b);a.prototype.init=function(c,a){var n=this;delete a.data;b.prototype.init.apply(n,arguments);var d=A(H,"afterLinkSeries",function(){if(n.options){var b=n.linkedParent,a=c.get(n.options.params.volumeSeriesID);n.addCustomEvents(b,a)}d()},{order:1});return n};a.prototype.addCustomEvents=function(c,b){function a(){d.chart.redraw();d.setData([]);d.zoneStarts=[];d.zoneLinesSVG&&(d.zoneLinesSVG=d.zoneLinesSVG.destroy())}
var d=this;d.dataEventsToUnbind.push(A(c,"remove",function(){a()}));b&&d.dataEventsToUnbind.push(A(b,"remove",function(){a()}));return d};a.prototype.animate=function(c){var b=this,a=b.chart.inverted,d=b.group,m={};!c&&d&&(c=a?b.yAxis.top:b.xAxis.left,a?(d["forceAnimate:translateY"]=!0,m.translateY=c):(d["forceAnimate:translateX"]=!0,m.translateX=c),d.animate(m,G(I(b.options.animation),{step:function(c,a){b.group.attr({scaleX:Math.max(.001,a.pos)})}})))};a.prototype.drawPoints=function(){this.options.volumeDivision.enabled&&
(this.posNegVolume(!0,!0),x.drawPoints.apply(this,arguments),this.posNegVolume(!1,!1));x.drawPoints.apply(this,arguments)};a.prototype.posNegVolume=function(b,a){var c=a?["positive","negative"]:["negative","positive"],d=this.options.volumeDivision,n=this.points.length,r=[],l=[],g=0,h;b?(this.posWidths=r,this.negWidths=l):(r=this.posWidths,l=this.negWidths);for(;g<n;g++){var e=this.points[g];e[c[0]+"Graphic"]=e.graphic;e.graphic=e[c[1]+"Graphic"];if(b){var y=e.shapeArgs.width;var v=this.priceZones[g];
(h=v.wholeVolumeData)?(r.push(y/h*v.positiveVolumeData),l.push(y/h*v.negativeVolumeData)):(r.push(0),l.push(0))}e.color=a?d.styles.positiveColor:d.styles.negativeColor;e.shapeArgs.width=a?this.posWidths[g]:this.negWidths[g];e.shapeArgs.x=a?e.shapeArgs.x:this.posWidths[g]}};a.prototype.translate=function(){var b=this,a=b.options,z=b.chart,d=b.yAxis,m=d.min,r=b.options.zoneLines,l=b.priceZones,g=0,h,e,y;x.translate.apply(b);var v=b.points;if(v.length){var f=.5>a.pointPadding?a.pointPadding:.1;a=b.volumeDataArray;
var p=E(a);var q=z.plotWidth/2;var M=z.plotTop;var k=u(d.toPixels(m)-d.toPixels(m+b.rangeStep));var w=u(d.toPixels(m)-d.toPixels(m+b.rangeStep));f&&(m=u(k*(1-2*f)),g=u((k-m)/2),k=u(m));v.forEach(function(a,c){e=a.barX=a.plotX=0;y=a.plotY=d.toPixels(l[c].start)-M-(d.reversed?k-w:k)-g;h=B(q*l[c].wholeVolumeData/p);a.pointWidth=h;a.shapeArgs=b.crispCol.apply(b,[e,y,h,k]);a.volumeNeg=l[c].negativeVolumeData;a.volumePos=l[c].positiveVolumeData;a.volumeAll=l[c].wholeVolumeData});r.enabled&&b.drawZones(z,
d,b.zoneStarts,r.styles)}};a.prototype.getValues=function(b,a){var c=b.processedXData,d=b.processedYData,m=this.chart,r=a.ranges,l=[],g=[],h=[],e=m.get(a.volumeSeriesID);if(b.chart)if(e&&e.processedXData.length)if((a=K(d[0]))&&4!==d[0].length)C("Type of "+b.name+" series is different than line, OHLC or candlestick.",!0,m);else return(this.priceZones=this.specifyZones(a,c,d,r,e)).forEach(function(b,a){l.push([b.x,b.end]);g.push(l[a][0]);h.push(l[a][1])}),{values:l,xData:g,yData:h};else C("Series "+
a.volumeSeriesID+(e&&!e.processedXData.length?" does not contain any data.":" not found! Check `volumeSeriesID`."),!0,m);else C("Base series not found! In case it has been removed, add a new one.",!0,m)};a.prototype.specifyZones=function(b,a,f,d,m){if(b){var c=f.length;for(var l=f[0][3],g=l,h=1,e;h<c;h++)e=f[h][3],e<l&&(l=e),e>g&&(g=e);c={min:l,max:g}}else c=!1;h=c;c=this.zoneStarts=[];l=[];g=h?h.min:J(f);e=h?h.max:E(f);var k=0;h=1;var n=this.linkedParent;!this.options.compareToMain&&n.dataModify&&
(g=n.dataModify.modifyValue(g),e=n.dataModify.modifyValue(e));if(!F(g)||!F(e))return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG&&(this.zoneLinesSVG=this.zoneLinesSVG.destroy())),[];n=this.rangeStep=B(e-g)/d;for(c.push(g);k<d-1;k++)c.push(B(c[k]+n));c.push(e);for(d=c.length;h<d;h++)l.push({index:h-1,x:a[0],start:c[h-1],end:c[h]});return this.volumePerZone(b,l,m,a,f)};a.prototype.volumePerZone=function(b,a,f,d,m){var c=this,l=f.processedXData,g=f.processedYData,h=a.length-
1,e=m.length;f=g.length;var k,n,p,t,q;u(e-f)&&(d[0]!==l[0]&&g.unshift(0),d[e-1]!==l[f-1]&&g.push(0));c.volumeDataArray=[];a.forEach(function(a){a.wholeVolumeData=0;a.positiveVolumeData=0;for(q=a.negativeVolumeData=0;q<e;q++){p=n=!1;t=b?m[q][3]:m[q];k=q?b?m[q-1][3]:m[q-1]:t;var d=c.linkedParent;!c.options.compareToMain&&d.dataModify&&(t=d.dataModify.modifyValue(t),k=d.dataModify.modifyValue(k));t<=a.start&&0===a.index&&(n=!0);t>=a.end&&a.index===h&&(p=!0);(t>a.start||n)&&(t<a.end||p)&&(a.wholeVolumeData+=
g[q],k>t?a.negativeVolumeData+=g[q]:a.positiveVolumeData+=g[q])}c.volumeDataArray.push(a.wholeVolumeData)});return a};a.prototype.drawZones=function(a,b,f,d){var c=a.renderer,k=a.plotWidth,l=a.plotTop,g=this.zoneLinesSVG,h=[],e;f.forEach(function(c){e=b.toPixels(c)-l;h=h.concat(a.renderer.crispLine([["M",0,e],["L",k,e]],d.lineWidth))});g?g.animate({d:h}):g=this.zoneLinesSVG=c.path(h).attr({"stroke-width":d.lineWidth,stroke:d.color,dashstyle:d.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)};
a.defaultOptions=L(D.defaultOptions,{params:{index:void 0,period:void 0,ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},animationLimit:1E3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",
padding:0,style:{fontSize:"0.5em"},verticalAlign:"top"}});return a}(D);G(a.prototype,{nameBase:"Volume by Price",nameComponents:["ranges"],calculateOn:{chart:"render",xAxis:"afterSetExtremes"},pointClass:b,markerAttribs:p,drawGraph:p,getColumnMetrics:x.getColumnMetrics,crispCol:x.crispCol});f.registerSeriesType("vbp",a);"";return a});k(b,"masters/indicators/volume-by-price.src.js",[],function(){})});//# sourceMappingURL=volume-by-price.js.map