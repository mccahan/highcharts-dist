/*
 Highcharts JS v11.1.0 (2023-08-20)

 Highcharts

 (c) 2010-2023 Highsoft AS

 License: www.highcharts.com/license
*/
'use strict';(function(l){"object"===typeof module&&module.exports?(l["default"]=l,module.exports=l):"function"===typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts"],function(r){l(r);l.Highcharts=r;return l}):l("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(l){function r(k,h,g,f){k.hasOwnProperty(h)||(k[h]=f.apply(null,g),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:h,module:k[h]}})))}l=l?l._modules:
{};r(l,"Data/Modifiers/DataModifier.js",[l["Core/Utilities.js"]],function(k){var h=k.addEvent,g=k.fireEvent,f=k.merge;k=function(){function e(){}e.prototype.benchmark=function(c,b){function a(){m.modifyTable(c);m.emit({type:"afterBenchmarkIteration"})}var d=[],m=this,n=f({iterations:1},b).iterations;m.on("afterBenchmarkIteration",function(){d.length===n?m.emit({type:"afterBenchmark",results:d}):a()});var e=0,z=0;m.on("modify",function(){e=window.performance.now()});m.on("afterModify",function(){z=
window.performance.now();d.push(z-e)});a();return d};e.prototype.emit=function(c){g(this,c.type,c)};e.prototype.modify=function(c,b){var a=this;return new Promise(function(d,m){c.modified===c&&(c.modified=c.clone(!1,b));try{d(a.modifyTable(c,b))}catch(n){a.emit({type:"error",detail:b,table:c}),m(n)}})};e.prototype.modifyCell=function(c){return this.modifyTable(c)};e.prototype.modifyColumns=function(c){return this.modifyTable(c)};e.prototype.modifyRows=function(c){return this.modifyTable(c)};e.prototype.on=
function(c,b){return h(this,c,b)};return e}();(function(e){e.types={};e.registerType=function(c,b){return!!c&&!e.types[c]&&!!(e.types[c]=b)}})(k||(k={}));return k});r(l,"Data/DataTable.js",[l["Core/Utilities.js"]],function(k){var h=k.addEvent,g=k.fireEvent,f=k.uniqueKey;k=function(){function e(c){void 0===c&&(c={});this.aliases={};this.autoId=!c.id;this.columns={};this.id=c.id||f();this.modified=this;this.rowCount=0;this.versionTag=f();for(var b=c.columns||{},a=Object.keys(b),d=this.columns,m=0,n=
0,e=a.length,z,v;n<e;++n)v=a[n],z=b[v].slice(),d[v]=z,m=Math.max(m,z.length);n=0;for(e=a.length;n<e;++n)d[a[n]].length=m;this.rowCount=m;c=c.aliases||{};b=Object.keys(c);a=this.aliases;n=0;for(e=b.length;n<e;++n)d=b[n],a[d]=c[d]}e.isNull=function(c){if(c===e.NULL)return!0;if(c instanceof Array){if(!c.length)return!1;for(var b=0,a=c.length;b<a;++b)if(null!==c[b])return!1}else{var d=Object.keys(c);if(!d.length)return!1;b=0;for(a=d.length;b<a;++b)if(null!==c[d[b]])return!1}return!0};e.prototype.clone=
function(c,b){var a={};this.emit({type:"cloneTable",detail:b});c||(a.aliases=this.aliases,a.columns=this.columns);this.autoId||(a.id=this.id);a=new e(a);c||(a.versionTag=this.versionTag);this.emit({type:"afterCloneTable",detail:b,tableClone:a});return a};e.prototype.deleteColumnAlias=function(c){var b,a=this.aliases[c],d=this.modifier;a&&(delete this.aliases[c],d&&d.modifyColumns(this,(b={},b[a]=Array(this.rowCount),b),0));return a};e.prototype.deleteColumns=function(c,b){var a=this.columns,d={},
m={},n=this.modifier,e=this.rowCount;c=c||Object.keys(a);if(c.length){this.emit({type:"deleteColumns",columnNames:c,detail:b});for(var f=0,v=c.length,g,h;f<v;++f){h=c[f];if(g=a[h])d[h]=g,m[h]=Array(e);delete a[h]}Object.keys(a).length||(this.rowCount=0);n&&n.modifyColumns(this,m,0,b);this.emit({type:"afterDeleteColumns",columns:d,columnNames:c,detail:b});return d}};e.prototype.deleteRows=function(c,b,a){void 0===b&&(b=1);var d=[],m=[],n=this.modifier;this.emit({type:"deleteRows",detail:a,rowCount:b,
rowIndex:c||0});"undefined"===typeof c&&(c=0,b=this.rowCount);if(0<b&&c<this.rowCount)for(var e=this.columns,f=Object.keys(e),v=0,h=f.length,g,k;v<h;++v){g=e[f[v]];k=g.splice(c,b);v||(this.rowCount=g.length);g=0;for(var p=k.length;g<p;++g)d[g]=d[g]||[],d[g][v]=k[g];m.push(Array(h))}n&&n.modifyRows(this,m,c||0,a);this.emit({type:"afterDeleteRows",detail:a,rowCount:b,rowIndex:c||0,rows:d});return d};e.prototype.emit=function(c){switch(c.type){case "afterDeleteColumns":case "afterDeleteRows":case "afterSetCell":case "afterSetColumns":case "afterSetRows":this.versionTag=
f()}g(this,c.type,c)};e.prototype.getCell=function(c,b){c=this.aliases[c]||c;if(c=this.columns[c])return c[b]};e.prototype.getCellAsBoolean=function(c,b){c=this.aliases[c]||c;c=this.columns[c];return!(!c||!c[b])};e.prototype.getCellAsNumber=function(c,b,a){c=this.aliases[c]||c;b=(c=this.columns[c])&&c[b];switch(typeof b){case "boolean":return b?1:0;case "number":return isNaN(b)&&!a?null:b}b=parseFloat("".concat(b));return isNaN(b)&&!a?null:b};e.prototype.getCellAsString=function(c,b){c=this.aliases[c]||
c;c=this.columns[c];return"".concat(c&&c[b])};e.prototype.getColumn=function(c,b){return this.getColumns([c],b)[c]};e.prototype.getColumnAliases=function(){for(var c=this.aliases,b=Object.keys(c),a={},d=0,m=b.length,n;d<m;++d)n=b[d],a[n]=c[n];return a};e.prototype.getColumnAsNumbers=function(c,b){var a=this.columns;c=this.aliases[c]||c;a=a[c];var d=[];if(a){var m=a.length;if(b)for(b=0;b<m;++b)d.push(this.getCellAsNumber(c,b,!0));else{b=0;for(var n;b<m;++b){n=a[b];if("number"===typeof n)return a.slice();
if(null!==n&&"undefined"!==typeof n)break}for(b=0;b<m;++b)d.push(this.getCellAsNumber(c,b))}}return d};e.prototype.getColumnNames=function(){return Object.keys(this.columns)};e.prototype.getColumns=function(c,b){var a=this.aliases,d=this.columns,m={};c=c||Object.keys(d);for(var n=0,e=c.length,f,v;n<e;++n)v=c[n],(f=d[a[v]||v])&&(m[v]=b?f:f.slice());return m};e.prototype.getModifier=function(){return this.modifier};e.prototype.getRow=function(c,b){return this.getRows(c,1,b)[0]};e.prototype.getRowCount=
function(){return this.rowCount};e.prototype.getRowIndexBy=function(c,b,a){c=this.aliases[c]||c;if(c=this.columns[c])if(b=c.indexOf(b,a),-1!==b)return b};e.prototype.getRowObject=function(c,b){return this.getRowObjects(c,1,b)[0]};e.prototype.getRowObjects=function(c,b,a){void 0===c&&(c=0);void 0===b&&(b=this.rowCount-c);var d=this.aliases,m=this.columns,n=Array(b);a=a||Object.keys(m);var e=c,f=0;c=Math.min(this.rowCount,c+b);for(var v;e<c;++e,++f){v=n[f]={};for(var g=0,h=a;g<h.length;g++){var k=h[g];
b=m[d[k]||k];v[k]=b?b[e]:void 0}}return n};e.prototype.getRows=function(c,b,a){void 0===c&&(c=0);void 0===b&&(b=this.rowCount-c);var d=this.aliases,m=this.columns,n=Array(b);a=a||Object.keys(m);var e=c,f=0;c=Math.min(this.rowCount,c+b);for(var v;e<c;++e,++f){b=n[f]=[];for(var g=0,h=a;g<h.length;g++)v=h[g],v=m[d[v]||v],b.push(v?v[e]:void 0)}return n};e.prototype.getVersionTag=function(){return this.versionTag};e.prototype.hasColumns=function(c){for(var b=this.aliases,a=this.columns,d=0,m=c.length,
n;d<m;++d)if(n=c[d],!a[n]&&!b[n])return!1;return!0};e.prototype.hasRowWith=function(c,b){c=this.aliases[c]||c;return(c=this.columns[c])?-1!==c.indexOf(b):!1};e.prototype.on=function(c,b){return h(this,c,b)};e.prototype.renameColumn=function(c,b){var a=this.columns;if(a[c]){if(c!==b){var d=this.aliases;d[b]&&delete d[b];a[b]=a[c];delete a[c]}return!0}return!1};e.prototype.setCell=function(c,b,a,d){var m=this.columns,n=this.modifier;c=this.aliases[c]||c;var e=m[c];e&&e[b]===a||(this.emit({type:"setCell",
cellValue:a,columnName:c,detail:d,rowIndex:b}),e||(e=m[c]=Array(this.rowCount)),b>=this.rowCount&&(this.rowCount=b+1),e[b]=a,n&&n.modifyCell(this,c,b,a),this.emit({type:"afterSetCell",cellValue:a,columnName:c,detail:d,rowIndex:b}))};e.prototype.setColumn=function(c,b,a,d){var m;void 0===b&&(b=[]);void 0===a&&(a=0);this.setColumns((m={},m[c]=b,m),a,d)};e.prototype.setColumnAlias=function(c,b){var a=this.aliases;return a[c]?!1:(a[c]=b,!0)};e.prototype.setColumns=function(c,b,a){var d=this.columns,m=
this.modifier,n="undefined"===typeof b,e=Object.keys(c);this.emit({type:"setColumns",columns:c,columnNames:e,detail:a,rowIndex:b});for(var f=0,v=e.length,g,h;f<v;++f)if(h=e[f],g=c[h],h=this.aliases[h]||h,n)d[h]=g.slice(),this.rowCount=g.length;else{h=d[h]?d[h]:d[h]=Array(this.rowCount);for(var k=b||0,p=g.length;k<p;++k)h[k]=g[k];this.rowCount=Math.max(this.rowCount,h.length)}n=Object.keys(d);f=0;for(v=n.length;f<v;++f)d[n[f]].length=this.rowCount;m&&m.modifyColumns(this,c,b||0);this.emit({type:"afterSetColumns",
columns:c,columnNames:e,detail:a,rowIndex:b})};e.prototype.setModifier=function(c,b){var a=this;a.emit({type:"setModifier",detail:b,modifier:c,modified:a.modified});a.modified=a;a.modifier=c;return(c?c.modify(a):Promise.resolve(a)).then(function(a){a.emit({type:"afterSetModifier",detail:b,modifier:c,modified:a.modified});return a})["catch"](function(d){a.emit({type:"setModifierError",error:d,modifier:c,modified:a.modified});throw d;})};e.prototype.setRow=function(c,b,a){this.setRows([c],b,a)};e.prototype.setRows=
function(c,b,a){void 0===b&&(b=this.rowCount);var d=this.aliases,m=this.columns,n=Object.keys(m),t=this.modifier,f=c.length;this.emit({type:"setRows",detail:a,rowCount:f,rowIndex:b,rows:c});for(var g=0,h=b,k;g<f;++g,++h)if(k=c[g],k===e.NULL)for(var l=0,p=n.length;l<p;++l)m[n[l]][h]=null;else if(k instanceof Array)for(l=0,p=n.length;l<p;++l)m[n[l]][h]=k[l];else{var w=Object.keys(k);l=0;p=w.length;for(var A;l<p;++l)A=w[l],A=d[A]||A,m[A]||(m[A]=Array(h+1)),m[A][h]=k[A]}d=b+f;if(d>this.rowCount)for(this.rowCount=
d,g=0,h=n.length;g<h;++g)m[n[g]].length=d;t&&t.modifyRows(this,c,b);this.emit({type:"afterSetRows",detail:a,rowCount:f,rowIndex:b,rows:c})};e.NULL={};return e}();"";return k});r(l,"Data/Connectors/DataConnector.js",[l["Data/Modifiers/DataModifier.js"],l["Data/DataTable.js"],l["Core/Utilities.js"]],function(k,h,g){var f=g.addEvent,e=g.fireEvent,c=g.merge,b=g.pick;g=function(){function a(a){void 0===a&&(a={});this.table=new h(a.dataTable);this.metadata=a.metadata||{columns:{}}}Object.defineProperty(a.prototype,
"polling",{get:function(){return!!this.polling},enumerable:!1,configurable:!0});a.prototype.describeColumn=function(a,b){var d=this.metadata.columns;d[a]=c(d[a]||{},b)};a.prototype.describeColumns=function(a){for(var d=Object.keys(a),b;"string"===typeof(b=d.pop());)this.describeColumn(b,a[b])};a.prototype.emit=function(a){e(this,a.type,a)};a.prototype.getColumnOrder=function(){var a=this.metadata.columns,c=Object.keys(a||{});if(c.length)return c.sort(function(d,c){return b(a[d].index,0)-b(a[c].index,
0)})};a.prototype.getSortedColumns=function(a){return this.table.getColumns(this.getColumnOrder(a))};a.prototype.load=function(){e(this,"afterLoad",{table:this.table});return Promise.resolve(this)};a.prototype.on=function(a,b){return f(this,a,b)};a.prototype.save=function(){e(this,"saveError",{table:this.table});return Promise.reject(Error("Not implemented"))};a.prototype.setColumnOrder=function(a){for(var b=0,d=a.length;b<d;++b)this.describeColumn(a[b],{index:b})};a.prototype.setModifierOptions=
function(a){var b=this,d=a&&k.types[a.type];return this.table.setModifier(d?new d(a):void 0).then(function(){return b})};a.prototype.startPolling=function(a){void 0===a&&(a=1E3);var b=this;window.clearTimeout(b._polling);b._polling=window.setTimeout(function(){return b.load()["catch"](function(a){return b.emit({type:"loadError",error:a,table:b.table})}).then(function(){b._polling&&b.startPolling(a)})},a)};a.prototype.stopPolling=function(){window.clearTimeout(this._polling);delete this._polling};
a.prototype.whatIs=function(a){return this.metadata.columns[a]};return a}();(function(a){a.types={};a.registerType=function(b,c){return!!b&&!a.types[b]&&!!(a.types[b]=c)}})(g||(g={}));return g});r(l,"Data/Converters/DataConverter.js",[l["Data/DataTable.js"],l["Core/Utilities.js"]],function(k,h){var g=h.addEvent,f=h.fireEvent,e=h.isNumber,c=h.merge;h=function(){function b(a){this.dateFormats={"YYYY/mm/dd":{regex:/^([0-9]{4})([\-\.\/])([0-9]{1,2})\2([0-9]{1,2})$/,parser:function(a){return a?Date.UTC(+a[1],
a[3]-1,+a[4]):NaN}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(a){return a?Date.UTC(+a[4],a[3]-1,+a[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(a){return a?Date.UTC(+a[4],a[1]-1,+a[3]):NaN}},"dd/mm/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(a){if(!a)return NaN;var b=+a[4];b=b>(new Date).getFullYear()-2E3?b+1900:b+2E3;return Date.UTC(b,a[3]-1,
+a[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(a){return a?Date.UTC(+a[4]+2E3,a[1]-1,+a[3]):NaN}}};a=c(b.defaultOptions,a);var d=a.decimalPoint;if("."===d||","===d)this.decimalRegExp=new RegExp("^(-?[0-9]+)"+("."===d?"\\.":",")+"([0-9]+)$");this.options=a}b.prototype.asBoolean=function(a){return"boolean"===typeof a?a:"string"===typeof a?""!==a&&"0"!==a&&"false"!==a:!!this.asNumber(a)};b.prototype.asDate=function(a){if("string"===
typeof a)a=this.parseDate(a);else if("number"!==typeof a){if(a instanceof Date)return a;a=this.parseDate(this.asString(a))}return new Date(a)};b.prototype.asGuessedType=function(a){return{number:this.asNumber,Date:this.asDate,string:this.asString}[this.guessType(a)].call(this,a)};b.prototype.asNumber=function(a){if("number"===typeof a)return a;if("boolean"===typeof a)return a?1:0;if("string"===typeof a){var b=this.decimalRegExp;-1<a.indexOf(" ")&&(a=a.replace(/\s+/g,""));if(b){if(!b.test(a))return NaN;
a=a.replace(b,"$1.$2")}return parseFloat(a)}return a instanceof Date?a.getDate():a?a.getRowCount():NaN};b.prototype.asString=function(a){return""+a};b.prototype.deduceDateFormat=function(a,b,c){var d=[],m=[],e="YYYY/mm/dd",f=[],g=0,h=!1,k,p;if(!b||b>a.length)b=a.length;for(;g<b;g++)if("undefined"!==typeof a[g]&&a[g]&&a[g].length){var l=a[g].trim().replace(/[-\.\/]/g," ").split(" ");f=["","",""];for(p=0;p<l.length;p++)p<f.length&&(k=parseInt(l[p],10))&&(m[p]=!m[p]||m[p]<k?k:m[p],"undefined"!==typeof d[p]?
d[p]!==k&&(d[p]=!1):d[p]=k,31<k?f[p]=100>k?"YY":"YYYY":12<k&&31>=k?(f[p]="dd",h=!0):f[p].length||(f[p]="mm"))}if(h){for(p=0;p<d.length;p++)!1!==d[p]?12<m[p]&&"YY"!==f[p]&&"YYYY"!==f[p]&&(f[p]="YY"):12<m[p]&&"mm"===f[p]&&(f[p]="dd");3===f.length&&"dd"===f[1]&&"dd"===f[2]&&(f[2]="YY");e=f.join("/")}c&&(this.options.dateFormat=e);return e};b.prototype.emit=function(a){f(this,a.type,a)};b.prototype.export=function(){this.emit({type:"exportError",columns:[],headers:[]});throw Error("Not implemented");
};b.prototype.getTable=function(){throw Error("Not implemented");};b.prototype.guessType=function(a){var b="string";if("string"===typeof a){var c=this.trim("".concat(a)),n=this.decimalRegExp;c=this.trim(c,!0);n&&(c=n.test(c)?c.replace(n,"$1.$2"):"");n=parseFloat(c);+c===n?a=n:(b=this.parseDate(a),b=e(b)?"Date":"string")}"number"===typeof a&&(b=31536E6<a?"Date":"number");return b};b.prototype.on=function(a,b){return g(this,a,b)};b.prototype.parse=function(){this.emit({type:"parseError",columns:[],
headers:[]});throw Error("Not implemented");};b.prototype.parseDate=function(a,b){var d=this.options,c=b||d.dateFormat;b=NaN;var f,g;if(d.parseDate)b=d.parseDate(a);else{if(c)(d=this.dateFormats[c])||(d=this.dateFormats["YYYY/mm/dd"]),(g=a.match(d.regex))&&(b=d.parser(g));else for(f in this.dateFormats)if(d=this.dateFormats[f],g=a.match(d.regex)){b=d.parser(g);break}g||(g=Date.parse(a),"object"===typeof g&&null!==g&&g.getTime?b=g.getTime()-6E4*g.getTimezoneOffset():e(g)&&(b=g-6E4*(new Date(g)).getTimezoneOffset(),
-1===a.indexOf("2001")&&2001===(new Date(b)).getFullYear()&&(b=NaN)))}return b};b.prototype.trim=function(a,b){"string"===typeof a&&(a=a.replace(/^\s+|\s+$/g,""),b&&/^[0-9\s]+$/.test(a)&&(a=a.replace(/\s/g,"")));return a};b.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1};return b}();(function(b){b.getTableFromColumns=function(a,b){void 0===a&&(a=[]);void 0===b&&(b=[]);for(var d=
new k,c=0,e=Math.max(b.length,a.length);c<e;++c)d.setColumn(b[c]||"".concat(c),a[c]);return d}})(h||(h={}));return h});r(l,"Data/DataCursor.js",[],function(){var k=function(){function h(g){void 0===g&&(g={});this.emittingRegister=[];this.listenerMap={};this.stateMap=g}h.prototype.addListener=function(g,f,e){g=this.listenerMap[g]=this.listenerMap[g]||{};(g[f]=g[f]||[]).push(e);return this};h.prototype.buildEmittingTag=function(g){return("position"===g.cursor.type?[g.table.id,g.cursor.column,g.cursor.row,
g.cursor.state,g.cursor.type]:[g.table.id,g.cursor.columns,g.cursor.firstRow,g.cursor.lastRow,g.cursor.state,g.cursor.type]).join("\x00")};h.prototype.emitCursor=function(g,f,e,c,b){var a="object"===typeof f?f:e;e="object"===typeof c?c:e;var d="string"===typeof f?f:void 0,m=g.id;f=a.state;if(f=this.listenerMap[m]&&this.listenerMap[m][f]){m=this.stateMap[m]=this.stateMap[m]||{};var n=m[a.state]||[];if(b||!0===c)n.length||(m[a.state]=n),-1===h.getIndex(a,n)&&n.push(a);g={cursor:a,cursors:n,table:g};
e&&(g.event=e);d&&(g.group=d);b=this.emittingRegister;c=this.buildEmittingTag(g);if(0<=b.indexOf(c))return this;try{this.emittingRegister.push(c);b=0;for(var t=f.length;b<t;++b)f[b].call(this,g)}finally{t=this.emittingRegister.indexOf(c),0<=t&&this.emittingRegister.splice(t,1)}}return this};h.prototype.remitCursor=function(g,f){if(g=this.stateMap[g]&&this.stateMap[g][f.state])f=h.getIndex(f,g),0<=f&&g.splice(f,1);return this};h.prototype.removeListener=function(g,f,e){(g=this.listenerMap[g]&&this.listenerMap[g][f])&&
(e=g.indexOf(e))&&g.splice(e,1);return this};return h}();(function(h){function g(f,e){var c,b,a,d;if("range"===f.type)return f;e={type:"range",firstRow:null!==(b=null!==(c=f.row)&&void 0!==c?c:e&&e.firstRow)&&void 0!==b?b:0,lastRow:null!==(d=null!==(a=f.row)&&void 0!==a?a:e&&e.lastRow)&&void 0!==d?d:Number.MAX_VALUE,state:f.state};"undefined"!==typeof f.column&&(e.columns=[f.column]);return e}h.getIndex=function(f,e){if("position"===f.type)for(var c,b=0,a=e.length;b<a;++b){if(c=e[b],"position"===
c.type&&c.state===f.state&&c.column===f.column&&c.row===f.row)return b}else{var d=JSON.stringify(f.columns);b=0;for(a=e.length;b<a;++b)if(c=e[b],"range"===c.type&&c.state===f.state&&c.firstRow===f.firstRow&&c.lastRow===f.lastRow&&JSON.stringify(c.columns)===d)return b}return-1};h.isEqual=function(f,e){return"position"===f.type&&"position"===e.type?f.column===e.column&&f.row===e.row&&f.state===e.state:"range"===f.type&&"range"===e.type?f.firstRow===e.firstRow&&f.lastRow===e.lastRow&&JSON.stringify(f.columns)===
JSON.stringify(e.columns):!1};h.isInRange=function(f,e){"position"===e.type&&(e=g(e));"position"===f.type&&(f=g(f,e));var c=f.columns,b=e.columns;return f.firstRow>=e.firstRow&&f.lastRow<=e.lastRow&&(!c||!b||c.every(function(a){return 0<=b.indexOf(a)}))};h.toPositions=function(f){if("position"===f.type)return[f];var e=f.columns||[],c=[],b=f.state,a=f.firstRow;for(f=f.lastRow;a<f;++a)if(e.length)for(var d=0,m=e.length;d<m;++d)c.push({type:"position",column:e[d],row:a,state:b});else c.push({type:"position",
row:a,state:b});return c};h.toRange=g})(k||(k={}));"";return k});r(l,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}});r(l,"Data/DataPool.js",[l["Data/Connectors/DataConnector.js"],l["Data/DataPoolDefaults.js"],l["Core/Utilities.js"]],function(k,h,g){return function(){function f(e){void 0===e&&(e=h);e.connectors=e.connectors||[];this.connectors={};this.options=e;this.waiting={}}f.prototype.emit=function(e){g.fireEvent(this,e.type,e)};f.prototype.getConnector=function(e){var c=this,
b=this.connectors[e];if(b)return Promise.resolve(b);var a=this.waiting[e];if(a)return new Promise(function(b){a.push(b)});this.waiting[e]=a=[];if(b=this.getConnectorOptions(e))return this.loadConnector(b).then(function(b){delete c.waiting[e];window.setTimeout(function(){for(var d=0,c=a.length;d<c;++d)a[d](b)},1);return b});throw Error("Connector not found. (".concat(e,")"));};f.prototype.getConnectorIds=function(){for(var e=this.options.connectors,c=[],b=0,a=e.length;b<a;++b)c.push(e[b].id);return c};
f.prototype.getConnectorOptions=function(e){for(var c=this.options.connectors,b=0,a=c.length;b<a;++b)if(c[b].id===e)return c[b]};f.prototype.getConnectorTable=function(e){return this.getConnector(e).then(function(c){return c.table})};f.prototype.loadConnector=function(e){var c=this;return new Promise(function(b,a){c.emit({type:"load",options:e});var d=k.types[e.type];if(!d)throw Error("Connector type not found. (".concat(e.type,")"));(new d(e.options)).load().then(function(a){c.emit({type:"afterLoad",
options:e});c.connectors[e.id]=a;b(a)})["catch"](a)})};f.prototype.on=function(e,c){return g.addEvent(this,e,c)};f.prototype.setConnectorOptions=function(e){var c=this.options.connectors;this.emit({type:"setConnectorOptions",options:e});for(var b=0,a=c.length;b<a;++b)if(c[b].id===e.id){c.splice(b,1);break}c.push(e);this.emit({type:"afterSetConnectorOptions",options:e})};return f}()});r(l,"Data/Formula/FormulaParser.js",[],function(){function k(a){for(var b=0,d=0,c=a.length,m,n=1;d<c;++d)if(m=a[d],
"("===m)b||(n=d+1),++b;else if(")"===m&&(--b,!b))return a.substring(n,d);if(0<b)throw a=Error("Incomplete parantheses."),a.name="FormulaParseError",a;return""}function h(a){for(var b=-1,d=0,c=a.length,m,n=!1;d<c;++d)if(m=a[d],"\\"===m)n=!n;else if(n)n=!1;else if('"'===m)if(0>b)b=d;else return a.substring(b+1,d);a=Error("Incomplete string.");a.name="FormulaParseError";throw a;}function g(a,b){var d;if(d=a.match(z)){a=""===d[2]||"["===d[2][0];b=""===d[1]||"["===d[1][0];var m=""===d[4]||"["===d[4][0],
n=""===d[3]||"["===d[3][0];d={type:"range",beginColumn:a?parseInt(d[2].substring(1,-1)||"0",10):parseInt(d[2],10)-1,beginRow:b?parseInt(d[1].substring(1,-1)||"0",10):parseInt(d[1],10)-1,endColumn:m?parseInt(d[4].substring(1,-1)||"0",10):parseInt(d[4],10)-1,endRow:n?parseInt(d[3].substring(1,-1)||"0",10):parseInt(d[3],10)-1};a&&(d.beginColumnRelative=!0);b&&(d.beginRowRelative=!0);m&&(d.endColumnRelative=!0);n&&(d.endRowRelative=!0);return d}if(d=a.match(t))return a="$"!==d[1][0],b="$"!==d[2][0],m=
"$"!==d[3][0],n="$"!==d[4][0],d={type:"range",beginColumn:c(a?d[1]:d[1].substring(1))-1,beginRow:parseInt(b?d[2]:d[2].substring(1),10)-1,endColumn:c(m?d[3]:d[3].substring(1))-1,endRow:parseInt(n?d[4]:d[4].substring(1),10)-1},a&&(d.beginColumnRelative=!0),b&&(d.beginRowRelative=!0),m&&(d.endColumnRelative=!0),n&&(d.endRowRelative=!0),d;d=e(a,b);return 1===d.length&&"string"!==typeof d[0]?d[0]:d}function f(a,b){for(var d=[],c=b?";":",",m=0,n="",e=0,f=a.length,t;e<f;++e)(t=a[e],t===c&&!m&&n)?(d.push(g(n,
b)),n=""):'"'!==t||m||n?" "!==t&&(n+=t,"("===t?++m:")"===t&&--m):(t=h(a.substring(e)),d.push(t),e+=t.length+1);!m&&n&&d.push(g(n,b));return d}function e(t,g){for(var z=g?d:a,C=[],u,q=("="===t[0]?t.substring(1):t).trim();q;)if(u=q.match(l)){var y=""===u[2]||"["===u[2][0],r=""===u[1]||"["===u[1][0],D={type:"reference",column:y?parseInt(u[2].substring(1,-1)||"0",10):parseInt(u[2],10)-1,row:r?parseInt(u[1].substring(1,-1)||"0",10):parseInt(u[1],10)-1};y&&(D.columnRelative=!0);r&&(D.rowRelative=!0);C.push(D);
q=q.substring(u[0].length).trim()}else if(u=q.match(v))y="$"!==u[1][0],r="$"!==u[2][0],D={type:"reference",column:c(y?u[1]:u[1].substring(1))-1,row:parseInt(r?u[2]:u[2].substring(1),10)-1},y&&(D.columnRelative=!0),r&&(D.rowRelative=!0),C.push(D),q=q.substring(u[0].length).trim();else if(u=q.match(n))C.push(u[0]),q=q.substring(u[0].length).trim();else if(u=q.match(b))C.push("TRUE"===u[0]),q=q.substring(u[0].length).trim();else if(u=q.match(z))C.push(parseFloat(u[0])),q=q.substring(u[0].length).trim();
else if('"'===q[0])u=h(q),C.push(u.substring(1,-1)),q=q.substring(u.length+2).trim();else if(u=q.match(m))q=q.substring(u[1].length).trim(),y=k(q),C.push({type:"function",name:u[1],args:f(y,g)}),q=q.substring(y.length+2).trim();else{if("("===q[0]&&(u=k(q))){C.push(e(u,g));q=q.substring(u.length+2).trim();continue}g=t.length-q.length;t=Error("Unexpected character `"+t.substring(g,g+1)+"` at position "+(g+1)+". (`..."+t.substring(g-5,g+6)+"...`)");t.name="FormulaParseError";throw t;}return C}function c(a){for(var b=
0,d=0,c=a.length,n,m=a.length-1;d<c;++d)n=a.charCodeAt(d),65<=n&&90>=n&&(b+=(n-64)*Math.pow(26,m)),--m;return b}var b=/^(?:FALSE|TRUE)/,a=/^[+-]?\d+(?:\.\d+)?(?:e[+-]\d+)?/,d=/^[+-]?\d+(?:,\d+)?(?:e[+-]\d+)?/,m=/^([A-Z][A-Z\d\.]*)\(/,n=/^(?:[+\-*\/^<=>]|<=|=>)/,t=/^(\$?[A-Z]+)(\$?\d+):(\$?[A-Z]+)(\$?\d+)/,z=/^R(\d*|\[\d+\])C(\d*|\[\d+\]):R(\d*|\[\d+\])C(\d*|\[\d+\])/,v=/^(\$?[A-Z]+)(\$?\d+)(?![:C])/,l=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!:)/;return{parseFormula:e}});r(l,"Data/Formula/FormulaTypes.js",
[],function(){var k="+ - * / ^ = < <= > >=".split(" ");return{isFormula:function(h){return h instanceof Array},isFunction:function(h){return"object"===typeof h&&!(h instanceof Array)&&"function"===h.type},isOperator:function(h){return"string"===typeof h&&0<=k.indexOf(h)},isRange:function(h){return"object"===typeof h&&!(h instanceof Array)&&"range"===h.type},isReference:function(h){return"object"===typeof h&&!(h instanceof Array)&&"reference"===h.type},isValue:function(h){return"boolean"===typeof h||
"number"===typeof h||"string"===typeof h}}});r(l,"Data/Formula/FormulaProcessor.js",[l["Data/Formula/FormulaTypes.js"]],function(k){function h(a){switch(typeof a){case "boolean":return a?q:w;case "string":return r;case "number":return a;default:return NaN}}function g(a){return"string"===typeof a?a.toLowerCase().replace(p,"\x00"):a}function f(a){switch(typeof a){case "boolean":return a?1:0;case "string":return parseFloat(a.replace(",","."));case "number":return a;default:return NaN}}function e(a,b,
d){switch(a){case "=":return g(b)===g(d);case "<":return typeof b===typeof d?g(b)<g(d):h(b)<h(d);case "<=":return typeof b===typeof d?g(b)<=g(d):h(b)<=h(d);case ">":return typeof b===typeof d?g(b)>g(d):h(b)>h(d);case ">=":return typeof b===typeof d?g(b)>=g(d):h(b)>=h(d)}b=f(b);d=f(d);switch(a){case "+":a=b+d;break;case "-":a=b-d;break;case "*":a=b*d;break;case "/":a=b/d;break;case "^":a=Math.pow(b,d);break;default:return NaN}return a%1?Math.round(1E9*a)/1E9:a}function c(a,c){return y(a)?a:l(a)?c&&
b(a,c)||[]:z(a)?m(a,c):d(t(a)?a:[a],c)}function b(a,b){for(var d=b.getColumnNames().slice(a.beginColumn,a.endColumn+1),c=[],n=0,m=d.length,e;n<m;++n)for(var f=b.getColumn(d[n],!0)||[],t=a.beginRow,g=a.endRow+1;t<g;++t)e=f[t],"string"===typeof e&&"="===e[0]&&b!==b.modified&&(e=b.modified.getCell(d[n],t)),c.push(y(e)?e:NaN);return c}function a(a,b){var d=b.getColumnNames()[a.column];if(d){var c=b.getCell(d,a.row);return"string"===typeof c&&"="===c[0]&&b!==b.modified?(a=b.modified.getCell(d,a.row),y(a)?
a:NaN):y(c)?c:NaN}return NaN}function d(b,c){var n=0,f=b.length,g=void 0,h;for(h=void 0;n<f;++n){var k=b[n];if(v(k))g=k;else if(y(k)?h=k:t(k)?h=d(b,c):z(k)?(h=m(k,c),h=y(h)?h:NaN):u(k)&&(h=c&&a(k,c)),"undefined"!==typeof h){if("undefined"===typeof l)var l=g?e(g,0,h):h;else if(g)k=b[n+1],v(k)&&x[k]>x[g]&&(h=e(k,h,d(b.slice(n+2))),n=f),l=e(g,l,h);else return NaN;h=g=void 0}}return y(l)?l:NaN}function m(a,b){var d=B[a.name];if(d)try{return d(a.args,b)}catch(E){return NaN}a=Error('Function "'.concat(a.name,
'" not found.'));a.name="FormulaProcessError";throw a;}function n(a,b,d){void 0===b&&(b=0);void 0===d&&(d=0);for(var c=0,m=a.length,e;c<m;++c)e=a[c],e instanceof Array?n(e):z(e)?n(e.args):l(e)?(e.beginColumnRelative&&(e.beginColumn+=b),e.beginRowRelative&&(e.beginRow+=d),e.endColumnRelative&&(e.endColumn+=b),e.endRowRelative&&(e.endRow+=d)):u(e)&&(e.columnRelative&&(e.column+=b),e.rowRelative&&(e.row+=d));return a}var t=k.isFormula,z=k.isFunction,v=k.isOperator,l=k.isRange,u=k.isReference,y=k.isValue,
p=/ */,w=Number.MAX_VALUE/1.000000000001,r=Number.MAX_VALUE/1.000000000002,q=Number.MAX_VALUE,x={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},B={},D=/^[A-Z][A-Z\.]*$/;return{asNumber:f,getArgumentValue:c,getArgumentsValues:function(a,b){for(var d=[],n=0,m=a.length;n<m;++n)d.push(c(a[n],b));return d},getRangeValues:b,getReferenceValue:a,processFormula:d,processorFunctions:B,registerProcessorFunction:function(a,b){return D.test(a)&&!B[a]&&!!(B[a]=b)},translateReferences:n}});r(l,"Data/Formula/Functions/ABS.js",
[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){f=g(f[0],e);switch(typeof f){case "number":return Math.abs(f);case "object":e=[];for(var c=0,b=f.length,a;c<b;++c){a=f[c];if("number"!==typeof a)return NaN;e.push(Math.abs(a))}return e;default:return NaN}}var g=k.getArgumentValue;k.registerProcessorFunction("ABS",h);return h});r(l,"Data/Formula/Functions/AND.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){for(var c=0,b=f.length,a;c<b;++c)if(a=g(f[c],e),!a||
"object"===typeof a&&!h(a,e))return!1;return!0}var g=k.getArgumentValue;k.registerProcessorFunction("AND",h);return h});r(l,"Data/Formula/Functions/AVERAGE.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){f=g(f,e);for(var c=e=0,b=0,a=f.length,d;b<a;++b)switch(d=f[b],typeof d){case "number":isNaN(d)||(++e,c+=d);break;case "object":for(var m=0,n=d.length,t;m<n;++m)t=d[m],"number"!==typeof t||isNaN(t)||(++e,c+=t)}return e?c/e:0}var g=k.getArgumentsValues;k.registerProcessorFunction("AVERAGE",
h);return h});r(l,"Data/Formula/Functions/AVERAGEA.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){for(var c=0,b=0,a=0,d=f.length,m;a<d;++a)switch(m=g(f[a],e),typeof m){case "boolean":++c;b+=m?1:0;continue;case "number":isNaN(m)||(++c,b+=m);continue;case "string":++c;continue;default:for(var n=0,t=m.length,h;n<t;++n)switch(h=m[n],typeof h){case "boolean":++c;b+=h?1:0;continue;case "number":isNaN(h)||(++c,b+=h);continue;case "string":++c}}return c?b/c:0}var g=k.getArgumentValue;
k.registerProcessorFunction("AVERAGEA",h);return h});r(l,"Data/Formula/Functions/COUNT.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(g,f){g=k.getArgumentsValues(g,f);for(var e=0,c=0,b=g.length,a;c<b;++c)switch(a=g[c],typeof a){case "number":isNaN(a)||++e;break;case "object":e+=h(a,f)}return e}k.registerProcessorFunction("COUNT",h);return h});r(l,"Data/Formula/Functions/COUNTA.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(g,f){g=k.getArgumentsValues(g,f);for(var e=
0,c=0,b=g.length,a;c<b;++c){a=g[c];switch(typeof a){case "number":if(isNaN(a))continue;break;case "object":e+=h(a,f);continue;case "string":if(!a)continue}++e}return e}k.registerProcessorFunction("COUNTA",h);return h});r(l,"Data/Formula/Functions/IF.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){return g(f[0],e)?g(f[1],e):g(f[2],e)}var g=k.getArgumentValue;k.registerProcessorFunction("IF",h);return h});r(l,"Data/Formula/Functions/ISNA.js",[l["Data/Formula/FormulaProcessor.js"]],
function(k){function h(f,e){f=g(f[0],e);return"number"!==typeof f||isNaN(f)}var g=k.getArgumentValue;k.registerProcessorFunction("ISNA",h);return h});r(l,"Data/Formula/Functions/MAX.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){f=g(f,e);e=Number.NEGATIVE_INFINITY;for(var c=0,b=f.length,a;c<b;++c)switch(a=f[c],typeof a){case "number":a>e&&(e=a);break;case "object":a=h(a),a>e&&(e=a)}return isFinite(e)?e:0}var g=k.getArgumentsValues;k.registerProcessorFunction("MAX",h);return h});
r(l,"Data/Formula/Functions/MEDIAN.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(g,f){var e=[];g=k.getArgumentsValues(g,f);f=0;for(var c=g.length,b;f<c;++f)switch(b=g[f],typeof b){case "number":isNaN(b)||e.push(b);break;case "object":for(var a=0,d=b.length,m;a<d;++a)m=b[a],"number"!==typeof m||isNaN(m)||e.push(m)}g=e.length;if(!g)return NaN;f=Math.floor(g/2);return g%2?e[f]:(e[f-1]+e[f])/2}k.registerProcessorFunction("MEDIAN",h);return h});r(l,"Data/Formula/Functions/MIN.js",
[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){f=g(f,e);e=Number.POSITIVE_INFINITY;for(var c=0,b=f.length,a;c<b;++c)switch(a=f[c],typeof a){case "number":a<e&&(e=a);break;case "object":a=h(a),a<e&&(e=a)}return isFinite(e)?e:0}var g=k.getArgumentsValues;k.registerProcessorFunction("MIN",h);return h});r(l,"Data/Formula/Functions/MOD.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){var c=g(f[0],e);f=g(f[1],e);"object"===typeof c&&(c=c[0]);"object"===typeof f&&
(f=f[0]);return"number"!==typeof c||"number"!==typeof f||0===f?NaN:c%f}var g=k.getArgumentValue;k.registerProcessorFunction("MOD",h);return h});r(l,"Data/Formula/Functions/MODE.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(e,c){var b={};e=k.getArgumentsValues(e,c);c=0;for(var a=e.length,d;c<a;++c)switch(d=e[c],typeof d){case "number":isNaN(d)||(b[d]=(b[d]||0)+1);break;case "object":for(var m=0,n=d.length,f;m<n;++m)f=d[m],"number"!==typeof f||isNaN(f)||(b[f]=(b[f]||0)+1)}return b}
function g(e,c){e=h(e,c);c=Object.keys(e);if(!c.length)return NaN;for(var b=[parseFloat(c[0])],a=e[c[0]],d=1,m=c.length,n,f;d<m;++d)n=c[d],f=e[n],a<f?(b=[parseFloat(n)],a=f):a===f&&b.push(parseFloat(n));return 1<a?b:NaN}function f(e,c){e=h(e,c);c=Object.keys(e);if(!c.length)return NaN;for(var b=parseFloat(c[0]),a=e[c[0]],d=1,m=c.length,n,f;d<m;++d)n=c[d],f=e[n],a<f?(b=parseFloat(n),a=f):a===f&&(n=parseFloat(n),b>n&&(b=n,a=f));return 1<a?b:NaN}k.registerProcessorFunction("MODE",f);k.registerProcessorFunction("MODE.MULT",
g);k.registerProcessorFunction("MODE.SNGL",f);return{MULT:g,SNGL:f}});r(l,"Data/Formula/Functions/NOT.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){f=g(f[0],e);"object"===typeof f&&(f=f[0]);switch(typeof f){case "boolean":case "number":return!f}return NaN}var g=k.getArgumentValue;k.registerProcessorFunction("NOT",h);return h});r(l,"Data/Formula/Functions/OR.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){for(var c=0,b=f.length,a;c<b;++c)if(a=g(f[c],
e),"object"===typeof a){if(h(a,e))return!0}else if(a)return!0;return!1}var g=k.getArgumentValue;k.registerProcessorFunction("OR",h);return h});r(l,"Data/Formula/Functions/PRODUCT.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){f=g(f,e);for(var c=1,b=!1,a=0,d=f.length,m;a<d;++a)switch(m=f[a],typeof m){case "number":isNaN(m)||(b=!0,c*=m);break;case "object":b=!0,c*=h(m,e)}return b?c:0}var g=k.getArgumentsValues;k.registerProcessorFunction("PRODUCT",h);return h});r(l,"Data/Formula/Functions/SUM.js",
[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(g,f){g=k.getArgumentsValues(g,f);for(var e=0,c=0,b=g.length,a;c<b;++c)switch(a=g[c],typeof a){case "number":isNaN(a)||(e+=a);break;case "object":e+=h(a,f)}return e}k.registerProcessorFunction("SUM",h);return h});r(l,"Data/Formula/Functions/XOR.js",[l["Data/Formula/FormulaProcessor.js"]],function(k){function h(f,e){for(var c=0,b=f.length,a=void 0,d;c<b;++c)switch(d=g(f[c],e),typeof d){case "boolean":case "number":if("undefined"===typeof a)a=
!!d;else if(!!d!==a)return!0;break;case "object":for(var m=0,n=d.length,t;m<n;++m)switch(t=d[m],typeof t){case "boolean":case "number":if("undefined"===typeof a)a=!!t;else if(!!t!==a)return!0}}return!1}var g=k.getArgumentValue;k.registerProcessorFunction("XOR",h);return h});r(l,"Data/Formula/Formula.js",[l["Data/Formula/FormulaParser.js"],l["Data/Formula/FormulaProcessor.js"],l["Data/Formula/FormulaTypes.js"]],function(k,h,g){var f=this&&this.__assign||function(){f=Object.assign||function(e){for(var c,
b=1,a=arguments.length;b<a;b++){c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(e[d]=c[d])}return e};return f.apply(this,arguments)};return f(f(f({},k),h),g)});r(l,"Data/Converters/CSVConverter.js",[l["Data/Converters/DataConverter.js"],l["Core/Utilities.js"]],function(k,h){var g=this&&this.__extends||function(){function c(b,a){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,
d)&&(a[d]=b[d])};return c(b,a)}return function(b,a){function d(){this.constructor=b}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");c(b,a);b.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)}}(),f=this&&this.__assign||function(){f=Object.assign||function(c){for(var b,a=1,d=arguments.length;a<d;a++){b=arguments[a];for(var m in b)Object.prototype.hasOwnProperty.call(b,m)&&(c[m]=b[m])}return c};return f.apply(this,
arguments)},e=h.merge;return function(c){function b(a){var d=e(b.defaultOptions,a);a=c.call(this,d)||this;a.columns=[];a.headers=[];a.dataTypes=[];a.options=d;return a}g(b,c);b.prototype.export=function(a,b){void 0===b&&(b=this.options);var d=b.useLocalDecimalPoint,c=b.lineDelimiter,e=!1!==this.options.firstRowAsNames,f=b.decimalPoint,g=b.itemDelimiter;f||(f=","!==g&&d?(1.1).toLocaleString()[1]:".");g||(g=","===f?";":",");b=a.getSortedColumns(b.usePresentationOrder);d=Object.keys(b);var h=[],k=d.length,
l=[];e&&h.push(d.map(function(a){return'"'.concat(a,'"')}).join(g));for(e=0;e<k;e++){var p=d[e],w=b[p],r=w.length,q=a.whatIs(p);p=void 0;q&&(p=q.dataType);for(q=0;q<r;q++){var x=w[q];l[q]||(l[q]=[]);"string"===p?x='"'+x+'"':"number"===typeof x?x=String(x).replace(".",f):"string"===typeof x&&(x='"'.concat(x,'"'));l[q][e]=x;if(e===k-1){for(x=e;2<l[q].length&&void 0===l[q][x];)l[q].pop(),x--;h.push(l[q].join(g))}}}return h.join(c)};b.prototype.parse=function(a,b){var d=this.dataTypes,c=e(this.options,
a),f=c.beforeParse,g=c.lineDelimiter,h=c.firstRowAsNames,k=c.itemDelimiter,l=c.csv;a=c.startRow;c=c.endRow;this.columns=[];this.emit({type:"parse",columns:this.columns,detail:b,headers:this.headers});l&&f&&(l=f(l));if(l){f=l.replace(/\r\n|\r/g,"\n").split(g||"\n");if(!a||0>a)a=0;if(!c||c>=f.length)c=f.length-1;k||(this.guessedItemDelimiter=this.guessDelimiter(f));if(h){k=f[0].split(k||this.guessedItemDelimiter||",");for(h=0;h<k.length;h++)k[h]=k[h].trim().replace(/^["']|["']$/g,"");this.headers=k;
a++}k=0;for(h=a;h<=c;h++)"#"===f[h][0]?k++:this.parseCSVRow(f[h],h-a-k);d.length&&d[0].length&&"date"===d[0][1]&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);h=0;for(a=this.columns.length;h<a;++h)for(d=this.columns[h],c=0,k=d.length;c<k;++c)d[c]&&"string"===typeof d[c]&&(f=this.asGuessedType(d[c]),f instanceof Date&&(f=f.getTime()),this.columns[h][c]=f)}this.emit({type:"afterParse",columns:this.columns,detail:b,headers:this.headers})};b.prototype.parseCSVRow=function(a,
b){function d(){if(k>x||x>l)++x,q="";else{"string"===typeof q?!isNaN(parseFloat(q))&&isFinite(q)?(q=parseFloat(q),c("number")):isNaN(Date.parse(q))?c("string"):(q=q.replace(/\//g,"-"),c("date")):c("number");f.length<B+1&&f.push([]);if("number"!==typeof q&&"number"!==e.guessType(q)&&p){var a=q;q=q.replace(p,".");"number"!==e.guessType(q)&&(q=a)}f[B][b]=q;q="";++B;++x}}function c(a){g.length<B+1&&g.push([a]);g[B][g[B].length-1]!==a&&g[B].push(a)}var e=this,f=e.columns||[],g=e.dataTypes,h=e.options,
k=h.startColumn,l=h.endColumn;h=e.options.itemDelimiter||e.guessedItemDelimiter;var p=e.options.decimalPoint;p&&p!==h||(p=e.guessedDecimalPoint||".");var w=0,r="",q="",x=0,B=0;if(a.trim().length&&"#"!==a.trim()[0]){for(;w<a.length;w++){r=a[w];if("#"===r&&!/^#[0-F]{3,3}|[0-F]{6,6}/i.test(a.substring(w))){d();return}if('"'===r)for(r=a[++w];w<a.length&&'"'!==r;)q+=r,r=a[++w];else r===h?d():q+=r}d()}};b.prototype.guessDelimiter=function(a){for(var b=0,c=0,e={",":0,";":0,"\t":0},f=a.length,g=0;g<f;g++){var h=
!1,k="";if(13<g)break;for(var l=a[g],r=0;r<l.length;r++){var p=l[r];var w=l[r+1];var A=l[r-1];if("#"===p)break;if('"'===p)if(h){if('"'!==A&&'"'!==w){for(;" "===w&&r<l.length;)w=l[++r];"undefined"!==typeof e[w]&&e[w]++;h=!1}}else h=!0;else"undefined"!==typeof e[p]?(k=k.trim(),isNaN(Date.parse(k))?!isNaN(Number(k))&&isFinite(Number(k))||e[p]++:e[p]++,k=""):k+=p;","===p&&c++;"."===p&&b++}}a=e[";"]>e[","]?";":",";this.guessedDecimalPoint=b>c?".":",";return a};b.prototype.getTable=function(){return k.getTableFromColumns(this.columns,
this.headers)};b.defaultOptions=f(f({},k.defaultOptions),{lineDelimiter:"\n"});return b}(k)});r(l,"Data/Connectors/CSVConnector.js",[l["Data/Converters/CSVConverter.js"],l["Data/Connectors/DataConnector.js"],l["Core/Utilities.js"]],function(k,h,g){var f=this&&this.__extends||function(){function c(b,a){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return c(b,a)}return function(b,
a){function d(){this.constructor=b}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");c(b,a);b.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)}}(),e=g.merge;g=function(c){function b(a){var d=e(b.defaultOptions,a);a=c.call(this,d)||this;a.converter=new k(d);a.options=d;d.enablePolling&&a.startPolling(1E3*Math.max(d.dataRefreshRate||0,1));return a}f(b,c);b.prototype.load=function(a){var b=this,c=b.converter,e=
b.table,f=b.options,g=f.csv,h=f.csvURL,k=f.dataModifier;b.emit({type:"load",csv:g,detail:a,table:e});e.deleteRows();return Promise.resolve(g?g:h?fetch(h||"").then(function(a){return a.text()}):"").then(function(a){a&&(c.parse({csv:a}),e.setColumns(c.getTable().getColumns()));return b.setModifierOptions(k).then(function(){return a})}).then(function(d){b.emit({type:"afterLoad",csv:d,detail:a,table:e});return b})["catch"](function(d){b.emit({type:"loadError",detail:a,error:d,table:e});throw d;})};b.defaultOptions=
{csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0};return b}(h);h.registerType("CSV",g);return g});r(l,"Data/Converters/GoogleSheetsConverter.js",[l["Data/Converters/DataConverter.js"],l["Core/Utilities.js"]],function(k,h){var g=this&&this.__extends||function(){function b(a,d){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return b(a,d)}return function(a,
d){function c(){this.constructor=a}if("function"!==typeof d&&null!==d)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");b(a,d);a.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}(),f=this&&this.__assign||function(){f=Object.assign||function(b){for(var a,d=1,c=arguments.length;d<c;d++){a=arguments[d];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e])}return b};return f.apply(this,arguments)},e=h.merge,c=h.uniqueKey;return function(b){function a(d){var c=
e(a.defaultOptions,d);d=b.call(this,c)||this;d.columns=[];d.header=[];d.options=c;return d}g(a,b);a.prototype.parse=function(a,b){a=e(this.options,a);var d=(a.json&&a.json.values||[]).map(function(a){return a.slice()});if(0===d.length)return!1;this.header=[];this.columns=[];this.emit({type:"parse",columns:this.columns,detail:b,headers:this.header});this.columns=d;for(var m,f=0,g=d.length;f<g;f++){m=d[f];this.header[f]=a.firstRowAsNames?"".concat(m.shift()):c();for(var h=0,k=m.length;h<k;++h)if(m[h]&&
"string"===typeof m[h]){var l=this.asGuessedType(m[h]);l instanceof Date&&(l=l.getTime());this.columns[f][h]=l}}this.emit({type:"afterParse",columns:this.columns,detail:b,headers:this.header})};a.prototype.getTable=function(){return k.getTableFromColumns(this.columns,this.header)};a.defaultOptions=f({},k.defaultOptions);return a}(k)});r(l,"Data/Connectors/GoogleSheetsConnector.js",[l["Data/Connectors/DataConnector.js"],l["Data/Converters/GoogleSheetsConverter.js"],l["Core/Utilities.js"]],function(k,
h,g){var f=this&&this.__extends||function(){function b(a,d){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return b(a,d)}return function(a,d){function c(){this.constructor=a}if("function"!==typeof d&&null!==d)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");b(a,d);a.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}(),
e=g.merge,c=g.pick;g=function(b){function a(d){var c=e(a.defaultOptions,d);d=b.call(this,c)||this;d.converter=new h(c);d.options=c;return d}f(a,b);a.prototype.load=function(b){var d=this,c=d.converter,e=d.table,f=d.options,g=f.dataModifier,h=f.dataRefreshRate,k=f.enablePolling,l=f.firstRowAsNames,p=a.buildFetchURL(f.googleAPIKey,f.googleSpreadsheetKey,d.options);d.emit({type:"load",detail:b,table:e,url:p});e.deleteColumns();return fetch(p).then(function(a){return a.json()}).then(function(a){if("object"===
typeof a&&a&&"object"===typeof a.error&&a.error&&"number"===typeof a.error.code&&"string"===typeof a.error.message&&"string"===typeof a.error.status)throw Error(a.error.message);c.parse({firstRowAsNames:l,json:a});e.setColumns(c.getTable().getColumns());return d.setModifierOptions(g)}).then(function(){d.emit({type:"afterLoad",detail:b,table:e,url:p});k&&setTimeout(function(){return d.load()},1E3*Math.max(h||0,1));return d})["catch"](function(a){d.emit({type:"loadError",detail:b,error:a,table:e});
throw a;})};a.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};return a}(k);(function(b){function a(a){void 0===a&&(a={});var b=a.endColumn,d=a.endRow,e=a.startColumn,f=a.startRow;return a.googleSpreadsheetRange||("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e||0]||"A")+(Math.max(f||0,0)+1)+":"+("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[c(b,25)]||"Z")+(d?Math.max(d,0):"Z")}b.buildFetchURL=function(b,c,e){void 0===e&&(e={});return"https://sheets.googleapis.com/v4/spreadsheets/".concat(c,
"/values/")+(e.onlyColumnNames?"A1:Z1":a(e))+"?alt=json"+(e.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+"&prettyPrint=false"+"&key=".concat(b)};b.buildQueryRange=a})(g||(g={}));k.registerType("GoogleSheets",g);return g});r(l,"Data/Converters/HTMLTableConverter.js",[l["Data/Converters/DataConverter.js"],l["Core/Utilities.js"]],function(k,h){var g=this&&this.__extends||function(){function c(b,a){c=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return c(b,a)}return function(b,a){function d(){this.constructor=b}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");c(b,a);b.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)}}(),f=this&&this.__assign||function(){f=Object.assign||function(c){for(var b,a=1,d=arguments.length;a<d;a++){b=arguments[a];
for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(c[e]=b[e])}return c};return f.apply(this,arguments)},e=h.merge;return function(c){function b(a){var d=e(b.defaultOptions,a);a=c.call(this,d)||this;a.columns=[];a.headers=[];a.options=d;d.tableElement&&(a.tableElement=d.tableElement,a.tableElementID=d.tableElement.id);return a}g(b,c);b.prototype.export=function(a,b){void 0===b&&(b=this.options);var d=!1!==b.firstRowAsNames,c=b.useMultiLevelHeaders,e=a.getSortedColumns(b.usePresentationOrder),
f=Object.keys(e);a=[];var g=f.length,h=[],k="";if(d)if(k=[],c){for(c=0;c<f.length;c++)d=(e[f[c]].shift()||"").toString(),k.push(d);k=this.getTableHeaderHTML(f,k,b)}else k=this.getTableHeaderHTML(void 0,f,b);for(c=0;c<g;c++){d=e[f[c]];for(var l=d.length,p=0;p<l;p++){var r=d[p];h[p]||(h[p]=[]);"string"!==typeof r&&"number"!==typeof r&&"undefined"!==typeof r&&(r=(r||"").toString());h[p][c]=this.getCellHTMLFromValue(c?"td":"th",null,c?"":'scope="row"',r);c===g-1&&a.push("<tr>"+h[p].join("")+"</tr>")}}e=
"";b.tableCaption&&(e='<caption class="highcharts-table-caption">'+b.tableCaption+"</caption>");return"<table>"+e+k+"<tbody>"+a.join("")+"</tbody></table>"};b.prototype.getCellHTMLFromValue=function(a,b,c,e,f){var d=e;b="text"+(b?" "+b:"");"number"===typeof d?(d=d.toString(),","===f&&(d=d.replace(".",f)),b="number"):e||(d="",b="empty");return"<"+a+(c?" "+c:"")+' class="'+b+'">'+d+"</"+a+">"};b.prototype.getTableHeaderHTML=function(a,b,c){void 0===a&&(a=[]);void 0===b&&(b=[]);void 0===c&&(c=this.options);
var d=c.useMultiLevelHeaders,e=c.useRowspanHeaders;c.useLocalDecimalPoint&&(1.1).toLocaleString();c="<thead>";var f=0,h=b&&b.length,g=0;if(d=d&&a&&b){a:if(d=a.length,b.length===d){for(;--d;)if(a[d]!==b[d]){d=!1;break a}d=!0}else d=!1;d=!d}if(d){for(c+="<tr>";f<h;++f){d=a[f];var m=a[f+1];d===m?++g:g?(c+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(g+1)+'"',d),g=0):(d===b[f]?e?(m=2,delete b[f]):(m=1,b[f]=""):m=1,c+=this.getCellHTMLFromValue("th","highcharts-table-topheading",
'scope="col"'+(1<m?' valign="top" rowspan="'+m+'"':""),d))}c+="</tr>"}if(b){c+="<tr>";f=0;for(h=b.length;f<h;++f)"undefined"!==typeof b[f]&&(c+=this.getCellHTMLFromValue("th",null,'scope="col"',b[f]));c+="</tr>"}return c+"</thead>"};b.prototype.parse=function(a,b){var d=[],c=[],f=e(this.options,a);a=f.endRow;var g=f.startColumn,h=f.endColumn,k=f.firstRowAsNames,l=f.tableElement||this.tableElement;if(l instanceof HTMLElement){this.tableElement=l;this.tableElementID=l.id;this.emit({type:"parse",columns:this.columns,
detail:b,headers:this.headers});l=l.getElementsByTagName("tr");var r=l.length,p=0;f=f.startRow;if(k&&r){for(var w=l[0].children,A=w.length,q=g;q<A&&!(q>h);q++)k=w[q],"TD"!==k.tagName&&"TH"!==k.tagName||c.push(k.innerHTML);f++}for(;p<r;){if(p>=f&&p<=a){w=l[p].children;A=w.length;for(var x=0;x<A;){q=x-g;var B=d[q];k=w[x];if(("TD"===k.tagName||"TH"===k.tagName)&&x>=g&&x<=h)for(d[q]||(d[q]=[]),k=this.asGuessedType(k.innerHTML),k instanceof Date&&(k=k.getTime()),d[q][p-f]=k,q=1;p-f>=q&&void 0===B[p-f-
q];)B[p-f-q]=null,q++;x++}}p++}this.columns=d;this.headers=c;this.emit({type:"afterParse",columns:d,detail:b,headers:c})}else this.emit({type:"parseError",columns:d,detail:b,headers:c,error:"Not a valid HTML Table"})};b.prototype.getTable=function(){return k.getTableFromColumns(this.columns,this.headers)};b.defaultOptions=f(f({},k.defaultOptions),{useRowspanHeaders:!0,useMultiLevelHeaders:!0});return b}(k)});r(l,"Data/Connectors/HTMLTableConnector.js",[l["Data/Connectors/DataConnector.js"],l["Core/Globals.js"],
l["Data/Converters/HTMLTableConverter.js"],l["Core/Utilities.js"]],function(k,h,g,f){var e=this&&this.__extends||function(){function a(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return a(b,c)}return function(b,c){function d(){this.constructor=b}if("function"!==typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(b,
c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),c=h.win,b=f.merge;h=function(a){function d(c){var e=b(d.defaultOptions,c);c=a.call(this,e)||this;c.converter=new g(e);c.options=e;return c}e(d,a);d.prototype.load=function(a){var d=this,e=d.converter,f=d.table,g=d.options,h=g.dataModifier;g=g.table;d.emit({type:"load",detail:a,table:f,tableElement:d.tableElement});f.deleteColumns();"string"===typeof g?(d.tableID=g,g=c.document.getElementById(g)):d.tableID=g.id;d.tableElement=
g||void 0;if(!d.tableElement)return d.emit({type:"loadError",detail:a,error:"HTML table not provided, or element with ID not found",table:f}),Promise.reject(Error("HTML table not provided, or element with ID not found"));e.parse(b({tableElement:d.tableElement},d.options),a);f.setColumns(e.getTable().getColumns());return d.setModifierOptions(h).then(function(){d.emit({type:"afterLoad",detail:a,table:f,tableElement:d.tableElement});return d})};d.defaultOptions={table:""};return d}(k);k.registerType("HTMLTable",
h);return h});r(l,"Data/Modifiers/ChainModifier.js",[l["Data/Modifiers/DataModifier.js"],l["Core/Utilities.js"]],function(k,h){var g=this&&this.__extends||function(){function e(c,b){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};return e(c,b)}return function(c,b){function a(){this.constructor=c}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+
" is not a constructor or null");e(c,b);c.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)}}(),f=h.merge;h=function(e){function c(b){for(var a=[],d=1;d<arguments.length;d++)a[d-1]=arguments[d];d=e.call(this)||this;d.chain=a;d.options=f(c.defaultOptions,b);for(var g=d.options.chain||[],h=0,l=g.length,z,v;h<l;++h)z=g[h],z.type&&(v=k.types[z.type])&&a.push(new v(z));return d}g(c,e);c.prototype.add=function(b,a){this.emit({type:"addModifier",detail:a,modifier:b});this.chain.push(b);
this.emit({type:"addModifier",detail:a,modifier:b})};c.prototype.clear=function(b){this.emit({type:"clearChain",detail:b});this.chain.length=0;this.emit({type:"afterClearChain",detail:b})};c.prototype.modify=function(b,a){function d(b){var d=e[b];f=f.then(function(b){return d.modify(b.modified,a)})}var c=this,e=this.options.reverse?this.chain.slice().reverse():this.chain.slice();b.modified===b&&(b.modified=b.clone(!1,a));for(var f=Promise.resolve(b),g=0,h=e.length;g<h;++g)d(g,h);f=f.then(function(a){b.modified.deleteColumns();
b.modified.setColumns(a.modified.getColumns());return b});return f=f["catch"](function(d){c.emit({type:"error",detail:a,table:b});throw d;})};c.prototype.modifyCell=function(b,a,d,c,e){var f=this.options.reverse?this.chain.reverse():this.chain;if(f.length){for(var g=b.clone(),h=0,m=f.length;h<m;++h)f[h].modifyCell(g,a,d,c,e),g=g.modified;b.modified=g}return b};c.prototype.modifyColumns=function(b,a,d,c){var e=this.options.reverse?this.chain.reverse():this.chain.slice();if(e.length){for(var f=b.clone(),
g=0,h=e.length;g<h;++g)e[g].modifyColumns(f,a,d,c),f=f.modified;b.modified=f}return b};c.prototype.modifyRows=function(b,a,d,c){var e=this.options.reverse?this.chain.reverse():this.chain.slice();if(e.length){for(var f=b.clone(),g=0,h=e.length;g<h;++g)e[g].modifyRows(f,a,d,c),f=f.modified;b.modified=f}return b};c.prototype.modifyTable=function(b,a){this.emit({type:"modify",detail:a,table:b});for(var d=this.options.reverse?this.chain.reverse():this.chain.slice(),c=b.modified,e=0,f=d.length,g;e<f;++e)g=
d[e],c=g.modifyTable(c,a).modified;b.modified=c;this.emit({type:"afterModify",detail:a,table:b});return b};c.prototype.remove=function(b,a){var c=this.chain;this.emit({type:"removeModifier",detail:a,modifier:b});c.splice(c.indexOf(b),1);this.emit({type:"afterRemoveModifier",detail:a,modifier:b})};c.defaultOptions={type:"Chain"};return c}(k);k.registerType("Chain",h);return h});r(l,"Data/Modifiers/InvertModifier.js",[l["Data/Modifiers/DataModifier.js"],l["Core/Utilities.js"]],function(k,h){var g=this&&
this.__extends||function(){function e(c,b){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};return e(c,b)}return function(c,b){function a(){this.constructor=c}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");e(c,b);c.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)}}(),f=h.merge;h=function(e){function c(b){var a=
e.call(this)||this;a.options=f(c.defaultOptions,b);return a}g(c,e);c.prototype.modifyCell=function(b,a,c,e,f){var d=b.modified;a=d.getRowIndexBy("columnNames",a);"undefined"===typeof a?d.setColumns(this.modifyTable(b.clone()).getColumns(),void 0,f):d.setCell("".concat(c),a,e,f);return b};c.prototype.modifyColumns=function(b,a,c,e){var d=b.modified,f=d.getColumn("columnNames")||[],g=b.getColumnNames(),h=b.getRowCount()!==f.length;if(!h)for(var k=0,m=g.length;k<m;++k)if(g[k]!==f[k]){h=!0;break}if(h)return this.modifyTable(b,
e);g=Object.keys(a);k=0;for(m=g.length;k<m;++k){h=g[k];f=a[h];h=d.getRowIndexBy("columnNames",h)||d.getRowCount();for(var l=0,p=c,r=f.length;l<r;++l,++p)d.setCell("".concat(p),h,f[l],e)}return b};c.prototype.modifyRows=function(b,a,c,e){var d=b.getColumnNames(),f=b.modified,g=f.getColumn("columnNames")||[],h=b.getRowCount()!==g.length;if(!h)for(var k=0,m=d.length;k<m;++k)if(d[k]!==g[k]){h=!0;break}if(h)return this.modifyTable(b,e);k=0;for(m=a.length;k<m;++k,++c)if(g=a[k],g instanceof Array)f.setColumn("".concat(c),
g);else{h=0;for(var l=d.length;h<l;++h)f.setCell("".concat(c),h,g[d[h]],e)}return b};c.prototype.modifyTable=function(b,a){this.emit({type:"modify",detail:a,table:b});var c=b.modified;if(b.hasColumns(["columnNames"]))for(var e=((b.deleteColumns(["columnNames"])||{}).columnNames||[]).map(function(a){return"".concat(a)}),f={},g=0,h=b.getRowCount(),k=void 0;g<h;++g)(k=b.getRow(g))&&(f[e[g]]=k);else{f={};g=0;h=b.getRowCount();for(k=void 0;g<h;++g)(k=b.getRow(g))&&(f["".concat(g)]=k);f.columnNames=b.getColumnNames()}c.deleteColumns();
c.setColumns(f);this.emit({type:"afterModify",detail:a,table:b});return b};c.defaultOptions={type:"Invert"};return c}(k);k.registerType("Invert",h);return h});r(l,"Data/Modifiers/MathModifier.js",[l["Data/Modifiers/DataModifier.js"],l["Data/Formula/FormulaParser.js"],l["Data/Formula/FormulaProcessor.js"]],function(k,h,g){var f=this&&this.__extends||function(){function b(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,
c)&&(a[c]=b[c])};return b(a,c)}return function(a,c){function d(){this.constructor=a}if("function"!==typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||function(){e=Object.assign||function(b){for(var a,c=1,e=arguments.length;c<e;c++){a=arguments[c];for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(b[f]=a[f])}return b};return e.apply(this,
arguments)},c=function(b){function a(c){var d=b.call(this)||this;d.options=e(e({},a.defaultOptions),c);return d}f(a,b);a.prototype.modifyTable=function(a,b){this.emit({type:"modify",detail:b,table:a});for(var c=this.options.alternativeSeparators,d=this.options.formulaColumns||a.getColumnNames(),e=a.modified,f=0,g=d.length,k;f<g;++f)k=d[f],0<=d.indexOf(k)&&e.setColumn(k,this.processColumn(a,k));d=this.options.columnFormulas||[];f=0;g=d.length;for(var m;f<g;++f)k=d[f],m=h.parseFormula(k.formula,c),
e.setColumn(k.column,this.processColumnFormula(m,a,k.rowStart,k.rowEnd));this.emit({type:"afterModify",detail:b,table:a});return a};a.prototype.processColumn=function(a,b,c){void 0===c&&(c=0);var d=this.options.alternativeSeparators;b=(a.getColumn(b,!0)||[]).slice(0<c?c:0);c=0;for(var e=b.length,f=[],k;c<e;++c)if(k=b[c],"string"===typeof k&&"="===k[0])try{f=""===k?f:h.parseFormula(k.substring(1),d),b[c]=g.processFormula(f,a)}catch(u){b[c]=NaN}return b};a.prototype.processColumnFormula=function(a,
b,c,e){void 0===c&&(c=0);void 0===e&&(e=b.getRowCount());c=0<=c?c:0;e=0<=e?e:b.getRowCount()+e;var d=[];b=b.modified;var f=0;for(c=e-c;f<c;++f)try{d[f]=g.processFormula(a,b)}catch(C){d[f]=NaN}finally{a=g.translateReferences(a,0,1)}return d};a.defaultOptions={type:"Math",alternativeSeparators:!1};return a}(k);k.registerType("Math",c);return c});r(l,"Data/Modifiers/RangeModifier.js",[l["Data/Modifiers/DataModifier.js"],l["Core/Utilities.js"]],function(k,h){var g=this&&this.__extends||function(){function e(c,
b){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};return e(c,b)}return function(c,b){function a(){this.constructor=c}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");e(c,b);c.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)}}(),f=h.merge;h=function(e){function c(b){var a=e.call(this)||
this;a.options=f(c.defaultOptions,b);return a}g(c,e);c.prototype.modifyTable=function(b,a){this.emit({type:"modify",detail:a,table:b});var c=this.options,e=c.additive,f=c.ranges;c=c.strict;if(f.length){for(var g=b.modified,h=b.getColumns(),k=[],l=0,r=f.length,y,p;l<r;++l)if(y=f[l],!c||typeof y.minValue===typeof y.maxValue){0<l&&!e&&(g.deleteRows(),g.setRows(k),h=g.getColumns(),k=[]);p=h[y.column]||[];for(var w=0,A=p.length,q;w<A;++w){q=p[w];switch(typeof q){default:continue;case "boolean":case "number":case "string":}(!c||
typeof q===typeof y.minValue)&&q>=y.minValue&&q<=y.maxValue&&(q=e?b.getRow(w):g.getRow(w))&&k.push(q)}}g.deleteRows();g.setRows(k)}this.emit({type:"afterModify",detail:a,table:b});return b};c.defaultOptions={type:"Range",ranges:[]};return c}(k);k.registerType("Range",h);return h});r(l,"Data/Modifiers/SortModifier.js",[l["Data/Modifiers/DataModifier.js"],l["Data/DataTable.js"],l["Core/Utilities.js"]],function(k,h,g){var f=this&&this.__extends||function(){function c(b,a){c=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};return c(b,a)}return function(b,a){function d(){this.constructor=b}if("function"!==typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");c(b,a);b.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)}}(),e=g.merge;g=function(c){function b(a){var d=c.call(this)||this;d.options=e(b.defaultOptions,a);return d}f(b,c);
b.ascending=function(a,b){return(a||0)<(b||0)?-1:(a||0)>(b||0)?1:0};b.descending=function(a,b){return(b||0)<(a||0)?-1:(b||0)>(a||0)?1:0};b.prototype.getRowReferences=function(a){a=a.getRows();for(var b=[],c=0,e=a.length;c<e;++c)b.push({index:c,row:a[c]});return b};b.prototype.modifyCell=function(a,b,c,e,f){var d=this.options,g=d.orderByColumn;d=d.orderInColumn;b===g&&(d?(a.modified.setCell(b,c,e),a.modified.setColumn(d,this.modifyTable(new h({columns:a.getColumns([g,d])})).modified.getColumn(d))):
this.modifyTable(a,f));return a};b.prototype.modifyColumns=function(a,b,c,e){var d=this.options,f=d.orderByColumn;d=d.orderInColumn;var g=Object.keys(b);-1<g.indexOf(f)&&(d&&b[g[0]].length?(a.modified.setColumns(b,c),a.modified.setColumn(d,this.modifyTable(new h({columns:a.getColumns([f,d])})).modified.getColumn(d))):this.modifyTable(a,e));return a};b.prototype.modifyRows=function(a,b,c,e){var d=this.options,f=d.orderByColumn;(d=d.orderInColumn)&&b.length?(a.modified.setRows(b,c),a.modified.setColumn(d,
this.modifyTable(new h({columns:a.getColumns([f,d])})).modified.getColumn(d))):this.modifyTable(a,e);return a};b.prototype.modifyTable=function(a,c){var d;this.emit({type:"modify",detail:c,table:a});var e=a.getColumnNames(),f=a.getRowCount(),g=this.getRowReferences(a),h=this.options,k=h.orderInColumn,l="asc"===h.direction?b.ascending:b.descending,r=e.indexOf(h.orderByColumn);e=a.modified;-1!==r&&g.sort(function(a,b){return l(a.row[r],b.row[r])});if(k){var p=[];for(h=0;h<f;++h)p[g[h].index]=h;e.setColumns((d=
{},d[k]=p,d))}else{d=[];for(h=0;h<f;++h)d.push(g[h].row);e.setRows(d,0)}this.emit({type:"afterModify",detail:c,table:a});return a};b.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"};return b}(k);k.registerType("Sort",g);return g});r(l,"masters/modules/data-tools.src.js",[l["Core/Globals.js"],l["Data/Connectors/DataConnector.js"],l["Data/Converters/DataConverter.js"],l["Data/DataCursor.js"],l["Data/Modifiers/DataModifier.js"],l["Data/DataPool.js"],l["Data/DataTable.js"],l["Data/Formula/Formula.js"]],
function(k,h,g,f,e,c,b,a){k.DataConnector=h;k.DataConverter=g;k.DataCursor=f;k.DataModifier=e;k.DataPool=c;k.DataTable=b;k.Formula=a})});//# sourceMappingURL=data-tools.js.map